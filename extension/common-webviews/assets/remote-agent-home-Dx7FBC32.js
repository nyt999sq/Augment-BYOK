import{v as ke,x as H,Z as Ke,ai as nt,aj as Qe,H as u,T as V,ae as X,S as N,a7 as se,N as r,P as m,R as o,L as O,Q as $,z as e,B as Ae,F as R,A as S,V as Ve,aa as ye,m as oe,ab as A,ad as rt,G as Ye,I as D,J as ce,O as ae,a6 as it,af as ve,ag as lt,K as et,X as tt,y as xe,C as at,D as st,_ as dt,aI as ot,at as gt,aL as Xe,Y as ct,aG as vt,aH as ut}from"./Icon-CaBYD5oO.js";import"./design-system-init-DCR3FqZN.js";/* empty css                                */import{M as mt}from"./message-broker-CliB7GoL.js";import{g as Je,R as pt,S as Me,v as ft,a as _t}from"./RemoteAgentStatusIndicator-qmKRPmeO.js";import{S as ht}from"./shared-webview-store-model-BEcw7czj.js";import{a as ne,R as Le,s as wt}from"./index-nbgGMYE9.js";import{T as Oe,a as ge,C as $t}from"./TextTooltipAugment-B4cqQh4H.js";import{C as yt}from"./CalloutAugment-DfDZpfuE.js";import{I as Be}from"./IconButtonAugment-Rffikxkp.js";import{b as St,s as bt}from"./utils-DpHtg3Qz.js";import{R as kt,B as At}from"./RepoBadge-DexbRR0E.js";import{R as Te}from"./remote-agents-client-DV0OXQaI.js";import"./types-CaiUesx9.js";try{$e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(qe=new $e.Error().stack)&&($e._sentryDebugIds=$e._sentryDebugIds||{},$e._sentryDebugIds[qe]="8068d575-cffa-406a-bfd3-391ae2917d99",$e._sentryDebugIdIdentifier="sentry-dbid-8068d575-cffa-406a-bfd3-391ae2917d99")}catch{}var $e,qe,Rt=u(" <!>",1),It=u('<div class="agent-card-footer svelte-1paeqiw"><!> <div class="time-container"><!></div></div>'),Pt=u('<div class="task-text-container svelte-4rg3b7"><!></div>'),jt=u('<div class="task-status-indicator svelte-4rg3b7"><!></div>'),zt=u('<div class="task-item svelte-4rg3b7"><div></div> <!> <!></div>'),Dt=u(' <button class="error-dismiss svelte-6tidju" aria-label="Dismiss error">×</button>',1),Ft=u('<div class="deletion-error svelte-6tidju"><!></div>'),Ht=u('<span class="setup-script-title svelte-6tidju">Generate a setup script</span>'),Ot=u('<div class="setup-script-title-container svelte-6tidju"><div class="setup-script-badge svelte-6tidju"><!></div> <!></div>'),Tt=u('<div class="tasks-list svelte-6tidju"></div>'),xt=u('<div class="card-commit-info svelte-6tidju"><!> <!></div>'),Et=u('<div class="card-header svelte-6tidju"><div class="session-summary-container svelte-6tidju"><!></div> <div class="card-info"><!></div></div> <div class="card-content svelte-6tidju"><!> <!></div> <div class="card-actions svelte-6tidju"><!> <!> <!></div> <!>',1),Ct=u("<div><!> <!></div>");function Wt(J,c){ke(c,!1);const y=oe(),I=oe(),F=oe(),Y=oe(),p=oe(),T=oe(),U=oe();let a=H(c,"agent",8),x=H(c,"selected",8,!1),h=H(c,"isPinned",8,!1),ue=H(c,"onSelect",8),me=H(c,"onDelete",8),Q=H(c,"deletionError",12,null),re=H(c,"isDeleting",8,!1),P=H(c,"onTogglePinned",24,()=>{}),w=H(c,"sshConfig",24,()=>{});function L(){Q(null)}Qe(()=>{L()}),ye(()=>(e(y),e(I),A(w())),()=>{var l;l=w()||{onSSH:()=>Promise.resolve(!1),canSSH:!1},R(y,l.onSSH),R(I,l.canSSH)}),ye(()=>A(a()),()=>{R(F,a().turn_summaries||[])}),ye(()=>{},()=>{R(Y,!0)}),ye(()=>A(a()),()=>{R(p,a().workspace_setup?.starting_files?.github_commit_ref?.repository_url)}),ye(()=>(e(p),Je),()=>{R(T,e(p)?Je(e(p)):void 0)}),ye(()=>A(a()),()=>{R(U,a().workspace_setup?.starting_files?.github_commit_ref?.git_ref)}),rt(),Ye();var i=Ct();let j;var je=m(i),Ee=l=>{var d=Ft(),ee=m(d);yt(ee,{variant:"soft",color:"error",size:1,icon:E=>{ce(E,{name:"circle-alert"})},children:(E,C)=>{var W=Dt(),G=O(W),ie=o(G);N(()=>se(G,`${Q()??""} `)),tt("click",ie,L),r(E,W)},$$slots:{icon:!0,default:!0}}),r(l,d)};$(je,l=>{Q()&&l(Ee)});var Ce=o(je,2);$t(Ce,{variant:"surface",size:2,interactive:!0,class:"agent-card",$$events:{click:()=>ue()(a().remote_agent_id),keydown:l=>l.key==="Enter"&&ue()(a().remote_agent_id)},children:(l,d)=>{var ee=Et(),te=O(ee),E=m(te),C=m(E),W=n=>{var s=Ot(),t=m(s),g=m(t);ce(g,{name:"terminal"});var z=o(t,2);V(z,{size:2,weight:"medium",children:(b,k)=>{var B=Ht();r(b,B)},$$slots:{default:!0}}),r(n,s)},G=n=>{V(n,{size:2,weight:"medium",class:"session-text",children:(s,t)=>{var g=X();N(()=>se(g,(A(a()),D(()=>a().session_summary)))),r(s,g)},$$slots:{default:!0}})};$(C,n=>{A(a()),D(()=>a().is_setup_script_agent)?n(W):n(G,!1)});var ie=o(E,2),Re=m(ie);pt(Re,{get status(){return A(a()),D(()=>a().status)},get workspaceStatus(){return A(a()),D(()=>a().workspace_status)},isExpanded:!0,get hasUpdates(){return A(a()),D(()=>a().has_updates)}});var pe=o(te,2),Ie=m(pe),We=n=>{var s=Tt();ve(s,5,()=>(e(F),D(()=>e(F).slice(0,3))),lt,(t,g)=>{(function(z,b){ke(b,!0);let k=H(b,"status",3,"info"),B=S(()=>function(Z){switch(Z){case"success":return"task-success";case"warning":return"task-warning";case"error":return"task-error";default:return"task-info"}}(k()));var fe=zt(),_e=m(fe),K=o(_e,2);{let Z=S(()=>[ge.Hover]);Oe(K,{get content(){return b.text},get triggerOn(){return e(Z)},maxWidth:"400px",children:(he,He)=>{var we=Pt(),q=m(we);V(q,{size:1,color:"secondary",children:(de,Ue)=>{var Ze=X();N(()=>se(Ze,b.text)),r(de,Ze)},$$slots:{default:!0}}),r(he,we)},$$slots:{default:!0}})}var M=o(K,2),le=Z=>{var he=jt(),He=m(he);{let we=S(()=>k()==="error"?"error":"neutral");V(He,{size:1,get color(){return e(we)},children:(q,de)=>{var Ue=X();N(()=>se(Ue,k()==="error"?"!":k()==="warning"?"⚠":"")),r(q,Ue)},$$slots:{default:!0}})}r(Z,he)};$(M,Z=>{k()!=="error"&&k()!=="warning"||Z(le)}),N(()=>Ve(_e,1,`bullet-point ${e(B)??""}`,"svelte-4rg3b7")),r(z,fe),Ae()})(t,{get text(){return e(g)},status:"success"})}),r(n,s)};$(Ie,n=>{e(F),D(()=>e(F).length>0)&&n(We)});var ze=o(Ie,2),Ge=n=>{var s=xt(),t=m(s);kt(t,{get repoUrl(){return e(p)},get repoName(){return e(T)}});var g=o(t,2);At(g,{get repoUrl(){return e(p)},get branchName(){return e(U)}}),r(n,s)};$(ze,n=>{e(p)&&e(T)&&e(U)&&n(Ge)});var Pe=o(pe,2),De=m(Pe),Ne=n=>{{let s=ae(()=>h()?"Unpin agent":"Pin agent"),t=ae(()=>(A(ge),D(()=>[ge.Hover])));Oe(n,{get content(){return e(s)},get triggerOn(){return e(t)},side:"top",children:(g,z)=>{Be(g,{variant:"ghost",color:"neutral",size:1,$$events:{click:b=>{b.stopPropagation(),P()()}},children:(b,k)=>{var B=et(),fe=O(B),_e=M=>{ce(M,{name:"pin-off"})},K=M=>{ce(M,{name:"pin"})};$(fe,M=>{h()?M(_e):M(K,!1)}),r(b,B)},$$slots:{default:!0}})},$$slots:{default:!0}})}};$(De,n=>{P()&&n(Ne)});var Fe=o(De,2),v=n=>{{let s=ae(()=>(A(ge),D(()=>[ge.Hover])));Oe(n,{content:"SSH to agent",get triggerOn(){return e(s)},side:"top",children:(t,g)=>{{let z=ae(()=>!e(I)),b=ae(()=>e(I)?"SSH to agent":"SSH to agent (agent must be running or idle)");Be(t,{get disabled(){return e(z)},variant:"ghost",color:"neutral",size:1,get title(){return e(b)},$$events:{click:k=>{k.stopPropagation(),e(y)()}},children:(k,B)=>{ce(k,{name:"terminal"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}};$(Fe,n=>{w()&&n(v)});var f=o(Fe,2);{let n=ae(()=>(A(ge),D(()=>[ge.Hover])));Oe(f,{content:"Delete agent",get triggerOn(){return e(n)},side:"top",children:(s,t)=>{{let g=ae(()=>re()?"Deleting agent...":"Delete agent");Be(s,{variant:"ghost",color:"neutral",size:1,get disabled(){return re()},get title(){return e(g)},$$events:{click:z=>{z.stopPropagation(),me()(a().remote_agent_id)}},children:(z,b)=>{ce(z,{name:"trash-2"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}var _=o(Pe,2);{let n=ae(()=>(A(a()),D(()=>a().updated_at||a().started_at)));(function(s,t){ke(t,!0);let g=H(t,"isRemote",3,!1),z=Ke(nt(St(t.timestamp)));const b=bt(t.timestamp,K=>{R(z,K,!0)});Qe(()=>{b()});var k=It(),B=m(k);V(B,{size:1,color:"secondary",class:"location-text",children:(K,M)=>{var le=X();N(()=>se(le,g()?"Running in the cloud":"Running locally")),r(K,le)},$$slots:{default:!0}});var fe=o(B,2),_e=m(fe);V(_e,{size:1,color:"secondary",class:"time-text",children:(K,M)=>{var le=Rt(),Z=O(le),he=o(Z),He=q=>{var de=X();N(()=>se(de,e(z))),r(q,de)},we=q=>{var de=X("Unknown time");r(q,de)};$(he,q=>{t.timestamp?q(He):q(we,!1)}),N(()=>se(Z,(t.status===ne.agentRunning?"Last updated":"Started")+" ")),r(K,le)},$$slots:{default:!0}}),r(s,k),Ae()})(_,{get isRemote(){return e(Y)},get status(){return A(a()),D(()=>a().status)},get timestamp(){return e(n)}})}N(()=>it(E,"title",(A(a()),D(()=>a().is_setup_script_agent?"Generate a setup script":a().session_summary)))),r(l,ee)},$$slots:{default:!0}}),N(l=>j=Ve(i,1,"card-wrapper svelte-6tidju",null,j,l),[()=>({"selected-card":x(),"setup-script-card":a().is_setup_script_agent,deleting:re()})]),r(J,i),Ae()}function Se(J,c){ke(c,!0);const y=()=>st(T,"$sharedWebviewStore",I),[I,F]=at();let Y=H(c,"selected",3,!1);const p=xe(Te.key),T=xe(Me);let U=Ke(!1),a=Ke(null),x=null;function h(){R(a,null),x&&(clearTimeout(x),x=null)}let ue=S(()=>y().state?.pinnedAgents||{}),me=S(()=>e(ue)?.[c.agent.remote_agent_id]===!0),Q=S(()=>c.agent.status===ne.agentRunning||c.agent.status===ne.agentIdle);async function re(){return!!e(Q)&&await(async P=>await p.sshToRemoteAgent(P.remote_agent_id))(c.agent)}{let P=S(()=>({onSSH:re,canSSH:e(Q)}));Wt(J,{get agent(){return c.agent},get selected(){return Y()},get isPinned(){return e(me)},get onSelect(){return c.onSelect},onDelete:()=>async function(w){h(),R(U,!0);const L=y().state?.agentOverviews||[];try{if(!await p.deleteRemoteAgent(w))throw new Error("Failed to delete agent");if(T.update(i=>{if(i)return{...i,agentOverviews:i.agentOverviews.filter(j=>j.remote_agent_id!==w)}}),(y().state?.pinnedAgents||{})[w])try{await p.deletePinnedAgentFromStore(w);const i=await p.getPinnedAgentsFromStore();T.update(j=>{if(j)return{...j,pinnedAgents:i}})}catch(i){console.error("Failed to remove pinned status:",i)}}catch(i){console.error("Failed to delete agent:",i),T.update(j=>{if(j)return{...j,agentOverviews:L}}),R(a,i instanceof Error?i.message:"Failed to delete agent",!0),x=setTimeout(()=>{h()},5e3)}finally{R(U,!1)}}(c.agent.remote_agent_id),onTogglePinned:()=>async function(w){try{e(me)?await p.deletePinnedAgentFromStore(w):await p.savePinnedAgentToStore(w,!0);const L=await p.getPinnedAgentsFromStore();T.update(i=>{if(i)return{...i,pinnedAgents:L}})}catch(L){console.error("Failed to toggle pinned status:",L)}}(c.agent.remote_agent_id),get sshConfig(){return e(P)},get deletionError(){return e(a)},set deletionError(w){R(a,w,!0)},get isDeleting(){return e(U)},set isDeleting(w){R(U,w,!0)}})}Ae(),F()}var Gt=u('<div class="section-header svelte-te8d84"><!></div>');function be(J,c){var y=Gt(),I=m(y);V(I,{size:2,color:"secondary",children:(F,Y)=>{var p=X();N(()=>se(p,c.title)),r(F,p)},$$slots:{default:!0}}),r(J,y)}var Nt=u('<div class="empty-state svelte-1verd7n"><div class="l-loading-container svelte-1verd7n"><!> <!></div></div>'),Ut=u('<div class="empty-state svelte-1verd7n"><!></div>'),Lt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),Bt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),Kt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),Mt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),Zt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),qt=u('<!> <div class="agent-grid svelte-1verd7n"></div>',1),Qt=u("<!> <!> <!> <!> <!> <!>",1),Vt=u('<div class="agent-list svelte-1verd7n"><!></div>'),Xt=u('<div class="l-main svelte-1foua77"><h1 class="l-main__title svelte-1foua77"><span class="l-main__title-logo svelte-1foua77"><!></span> Remote Agents</h1> <!></div>');ut(function(J,c){ke(c,!1);const y=new mt(gt),I=new ht(y,void 0,ft,_t);y.registerConsumer(I),Xe(Me,I);const F=new Te(y);Xe(Te.key,F),ct(()=>(I.fetchStateFromExtension().then(()=>{I.update(a=>{if(!a)return;const x=[...a.activeWebviews,"home"];return a.pinnedAgents?{...a,activeWebviews:x}:{...a,activeWebviews:x,pinnedAgents:{}}})}),()=>{y.dispose(),F.dispose()})),Ye();var Y=Xt();tt("message",vt,function(...a){y.onMessageFromExtension?.apply(this,a)});var p=m(Y),T=m(p),U=m(T);ce(U,{name:"augment-logo"}),function(a,x){ke(x,!0);const h=()=>st(Q,"$sharedWebviewStore",ue),[ue,me]=at(),Q=xe(Me),re=xe(Te.key);function P(l){Q.update(d=>{if(d)return{...d,selectedAgentId:l}})}let w=S(()=>wt(h().state?.agentOverviews||[])),L=S(()=>h().state?.pinnedAgents||{}),i=S(()=>e(w).reduce((l,d)=>(e(L)?.[d.remote_agent_id]===!0?l.pinned.push(d):d.status===ne.agentIdle&&d.has_updates?l.readyToReview.push(d):d.status===ne.agentRunning||d.status===ne.agentStarting||d.workspace_status===Le.workspaceResuming?l.running.push(d):d.status===ne.agentFailed?l.failed.push(d):d.status===ne.agentIdle||d.workspace_status===Le.workspacePaused||d.workspace_status===Le.workspacePausing?l.idle.push(d):l.additional.push(d),l),{pinned:[],readyToReview:[],running:[],idle:[],failed:[],additional:[]}));dt(()=>{h().state?.agentOverviews||re.focusAugmentPanel()});var j=Vt(),je=m(j),Ee=l=>{var d=Nt(),ee=m(d),te=m(ee);ot(te,{});var E=o(te,2);V(E,{size:3,color:"secondary",children:(C,W)=>{var G=X("Loading the Augment panel...");r(C,G)},$$slots:{default:!0}}),r(l,d)},Ce=l=>{var d=et(),ee=O(d),te=C=>{var W=Ut(),G=m(W);V(G,{size:3,color:"secondary",children:(ie,Re)=>{var pe=X("No agents available");r(ie,pe)},$$slots:{default:!0}}),r(C,W)},E=C=>{var W=Qt(),G=O(W),ie=v=>{var f=Lt(),_=O(f);be(_,{title:"Pinned"});var n=o(_,2);ve(n,23,()=>e(i).pinned,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(G,v=>{e(i).pinned.length>0&&v(ie)});var Re=o(G,2),pe=v=>{var f=Bt(),_=O(f);be(_,{title:"Ready to review"});var n=o(_,2);ve(n,23,()=>e(i).readyToReview,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(Re,v=>{e(i).readyToReview.length>0&&v(pe)});var Ie=o(Re,2),We=v=>{var f=Kt(),_=O(f);be(_,{title:"Running agents"});var n=o(_,2);ve(n,23,()=>e(i).running,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(Ie,v=>{e(i).running.length>0&&v(We)});var ze=o(Ie,2),Ge=v=>{var f=Mt(),_=O(f);be(_,{title:"Idle agents"});var n=o(_,2);ve(n,23,()=>e(i).idle,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(ze,v=>{e(i).idle.length>0&&v(Ge)});var Pe=o(ze,2),De=v=>{var f=Zt(),_=O(f);be(_,{title:"Failed agents"});var n=o(_,2);ve(n,23,()=>e(i).failed,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(Pe,v=>{e(i).failed.length>0&&v(De)});var Ne=o(Pe,2),Fe=v=>{var f=qt(),_=O(f);be(_,{title:"Other agents"});var n=o(_,2);ve(n,23,()=>e(i).additional,(s,t)=>s.remote_agent_id+t,(s,t)=>{{let g=S(()=>e(t).remote_agent_id===h().state?.selectedAgentId);Se(s,{get agent(){return e(t)},get selected(){return e(g)},onSelect:P})}}),r(v,f)};$(Ne,v=>{e(i).additional.length>0&&v(Fe)}),r(C,W)};$(ee,C=>{h().state?.agentOverviews.length===0?C(te):C(E,!1)},!0),r(l,d)};$(je,l=>{h().state?.agentOverviews?l(Ce,!1):l(Ee)}),r(a,j),Ae(),me()}(o(p,2),{}),r(J,Y),Ae()},{target:document.getElementById("app")});
//# sourceMappingURL=remote-agent-home-Dx7FBC32.js.map
