import{v as te,x as g,Z as h,ai as ne,_ as A,z as l,F as s,aj as oe,H as ie,L as ae,a4 as _,a5 as I,P as f,R as v,ak as se,Q as B,N as C,B as re,T as H,ae as R,S as de,a7 as le}from"./Icon-CaBYD5oO.js";import"./IconButtonAugment-Rffikxkp.js";import{S as ce,M as ue}from"./index-DF_yYUtg.js";import{D as F}from"./OpenFileButton-BnBhQVIy.js";try{u=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(V=new u.Error().stack)&&(u._sentryDebugIds=u._sentryDebugIds||{},u._sentryDebugIds[V]="ab5da2b9-a916-4d01-8374-055ef6abcb69",u._sentryDebugIdIdentifier="sentry-dbid-ab5da2b9-a916-4d01-8374-055ef6abcb69")}catch{}var u,V,ge=ie('<div class="l-markdown-editor svelte-6764n4"><div class="c-markdown-editor__header svelte-6764n4"><!></div> <!> <div class="c-markdown-editor__content svelte-6764n4"><!> <div class="c-monaco-editor svelte-6764n4"><!></div></div></div> <div class="c-markdown-editor__status svelte-6764n4"><!> <!></div>',1);function he(D,a){te(a,!0);let r=g(a,"value",15,""),M=g(a,"selectedText",15,""),T=g(a,"selectionStart",15,0),E=g(a,"selectionEnd",15,0),W=g(a,"monacoOptions",19,()=>({})),t=g(a,"editorInstance",15),d=h(ne(r())),m=!1;const j={readOnly:!1,wordWrap:"on",lineNumbers:"on",minimap:{enabled:!1},scrollBeyondLastLine:!1,automaticLayout:!0,theme:"vs-dark",language:"markdown",fontSize:F.fontSize,lineHeight:F.lineHeight,padding:{top:16,bottom:16},...W()};let w,b,p,y=h(!1),L=h(!1),k=h(void 0);const S=async()=>{t()&&await(async()=>{if(l(y))try{if(t()){const e=t().getValue();s(d,e,!0),r(e)}a.saveFunction(),s(y,!1),s(L,!0),clearTimeout(w),w=setTimeout(()=>{s(L,!1)},1500)}catch(e){s(k,e instanceof Error?e.message:String(e),!0)}})()},G=()=>{if(!t()||m)return;const e=t().getValue();e!==l(d)&&(s(d,e,!0),r(e),s(y,!0))},Q=()=>{if(!t())return;let e,o,i;e=t().onDidChangeModelContent(G),i=t().onDidBlurEditorWidget(()=>{S()}),o=t().addAction({id:"save-markdown-content",label:"Save Markdown Content",keybindings:[2097],contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:()=>{S()}}),(()=>{if(typeof window>"u")return;const n=()=>{S()};window.addEventListener("blur",n),p=()=>{window.removeEventListener("blur",n)}})(),b=()=>{e?.dispose(),o?.dispose(),i?.dispose(),p?.()}};A(()=>{if(r()!==l(d))if(t()){if(!m){m=!0;const e=t().getPosition(),o=t().getSelection(),i=t().getModel();if(i&&i.getValue()!==r()){if(i.setValue(r()),s(d,r(),!0),e&&i.getLineCount()>=e.lineNumber){const n=i.getLineLength(e.lineNumber);e.column<=n+1&&t().setPosition(e)}if(o&&i.getLineCount()>=o.endLineNumber){const n=i.getLineLength(o.endLineNumber);o.endColumn<=n+1&&t().setSelection(o)}}setTimeout(()=>{m=!1},10)}}else s(d,r(),!0)}),A(()=>{if(t()){Q();const e=t(),o=e.onDidChangeCursorSelection(()=>{const n=e.getSelection();if(n){const c=e.getModel();c&&(T(c.getOffsetAt(n.getStartPosition())),E(c.getOffsetAt(n.getEndPosition())),T()!==E()?M(c.getValueInRange(n)):M(""))}}),i=b;b=()=>{i?.(),o?.dispose()}}}),oe(()=>{clearTimeout(w),b?.(),p?.()});var x=ge(),N=ae(x),$=f(N),Z=f($);_(Z,()=>a.header??I);var z=v($,2);_(z,()=>a.children??I);var q=v(z,2),O=f(q);_(O,()=>a.title??I);var J=v(O,2),K=f(J);se(K,()=>ue.Root,(e,o)=>{o(e,{children:(i,n)=>{ce(i,{get text(){return l(d)},lang:"markdown",get options(){return j},height:void 0,get editorInstance(){return t()},set editorInstance(c){t(c)}})},$$slots:{default:!0}})});var U=v(N,2),P=f(U),X=e=>{H(e,{size:1,weight:"light",color:"error",children:(o,i)=>{var n=R();de(()=>le(n,l(k))),C(o,n)},$$slots:{default:!0}})};B(P,e=>{l(k)&&e(X)});var Y=v(P,2),ee=e=>{H(e,{size:1,weight:"light",color:"success",children:(o,i)=>{var n=R("Saved");C(o,n)},$$slots:{default:!0}})};B(Y,e=>{l(L)&&e(ee)}),C(D,x),re()}export{he as M};
//# sourceMappingURL=MonacoMarkdownEditor-BBd4goIb.js.map
