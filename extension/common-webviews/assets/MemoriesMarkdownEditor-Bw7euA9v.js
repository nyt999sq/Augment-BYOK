import{v as Te,x as $e,at as Re,D as x,Y as ke,W as Ae,w as ge,aa as te,ac as Ne,C as Pe,F as c,z as e,m as z,ab as me,ad as Be,G as He,K as xe,L as se,Q as le,N as l,B as Ge,a3 as he,H as A,J as k,ae as q,S as Se,a7 as Ce,I as O,O as ae,R as J,af as Ue,ag as We,P as b,T as Le,Z as ne,A as Me}from"./Icon-CaBYD5oO.js";import{M as Ve}from"./MonacoMarkdownEditor-BBd4goIb.js";import{i as oe,E as qe,D,a as Je,b as Ke,o as Qe,M as pe,c as Ye,s as Ze}from"./extension-client-context-CwKdOhUw.js";import{S as je}from"./SuccessfulButton-Df7hGnns.js";import{O as Xe}from"./OpenFileButton-BnBhQVIy.js";import{F as et}from"./Filespan-CzwbVFJm.js";import{M as tt}from"./message-broker-CliB7GoL.js";import{T as ze,a as re}from"./TextTooltipAugment-B4cqQh4H.js";import{B as Ie}from"./ButtonAugment-DECgcPdk.js";try{_=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(we=new _.Error().stack)&&(_._sentryDebugIds=_._sentryDebugIds||{},_._sentryDebugIds[we]="4db6302f-d057-4c7c-be18-c2ae4685f76c",_._sentryDebugIdIdentifier="sentry-dbid-4db6302f-d057-4c7c-be18-c2ae4685f76c")}catch{}var _,we,st=A("<!> <!>",1),at=A('<div class="rules-dropdown-content svelte-16zpwc"><!> <!></div>'),nt=A("<!> <!>",1);function ot(K,i){Te(i,!1);const n=()=>x(d,"$rulesFiles",r),f=()=>x(Q,"$selectedRule",r),s=()=>x(e(I),"$focusedIndex",r),[r,N]=Pe(),I=z(),g=z(),P=z(),T=z();let ie=$e(i,"onRuleSelected",8),B=$e(i,"disabled",8,!1);const de=new tt(Re),ce=oe("enableRules"),t=oe("enablePersonalities"),a=oe("enableExternalSourcesInChat"),m=oe("retryChatStreamTimeouts"),h=new qe(Re,de,{enableRules:x(ce,"$enableRules",r),enablePersonalities:x(t,"$enablePersonalities",r),enableExternalSourcesInChat:x(a,"$enableExternalSourcesInChat",r),retryChatStreamTimeouts:x(m,"$retryChatStreamTimeouts",r)}),d=ge([]),y=ge(!0),Q=ge(void 0);let S=z();ke(()=>{(async function(){try{y.set(!0);const u=await h.findRules("",100);d.set(u)}catch(u){console.error("Failed to load rules:",u),d.set([])}finally{y.set(!1)}})();const o=u=>{u.data?.type===Ae.getRulesListResponse&&(d.set(u.data.data||[]),y.set(!1))};return window.addEventListener("message",o),()=>{window.removeEventListener("message",o)}});let G=z(),Y=z(!1);function C(o){c(Y,o)}te(()=>e(S),()=>{Ne(c(I,e(S)?.focusedIndex),"$focusedIndex",r)}),te(()=>n(),()=>{c(g,n().length>0)}),te(()=>(me(B()),e(g)),()=>{c(P,B()||!e(g))}),te(()=>e(g),()=>{c(T,e(g)?"Move highlighted text to a .augment/rules file":"Please add at least 1 file to .augment/rules and reload VSCode")}),Be(),He();var H=xe(),p=se(H),L=o=>{var u=xe(),ue=se(u),w=E=>{he(D.Root(E,{onOpenChange:C,children:(U,Z)=>{var ve=nt(),R=se(ve);D.Trigger(R,{children:(W,Fe)=>{{let X=ae(()=>(me(re),O(()=>[re.Hover]))),ee=ae(()=>!e(Y)&&void 0);he(ze(W,{get content(){return e(T)},get triggerOn(){return e(X)},side:"top",get open(){return e(ee)},children:(V,be)=>{Ie(V,{color:"neutral",variant:"soft",size:1,get disabled(){return e(P)},children:(v,$)=>{var M=q();Se(()=>Ce(M,(f(),O(()=>f()?f().path:"Rules")))),l(v,M)},$$slots:{default:!0,iconLeft:(v,$)=>{k(v,{slot:"iconLeft",name:"arrow-right"})},iconRight:(v,$)=>{k(v,{slot:"iconRight",name:"chevron-down"})}}})},$$slots:{default:!0},$$legacy:!0}),V=>c(G,V),()=>e(G))}},$$slots:{default:!0}});var j=J(R,2);D.Content(j,{side:"bottom",align:"start",children:(W,Fe)=>{var X=at(),ee=b(X);Ue(ee,1,n,We,(v,$,M)=>{{let fe=ae(()=>s()===M);D.Item(v,{onSelect:()=>function(F){Q.set(F),ie()(F),e(S)?.requestClose()}(e($)),get highlight(){return e(fe)},children:(F,_e)=>{et(F,{get filepath(){return e($),O(()=>e($).path)}})},$$slots:{default:!0}})}});var V=J(ee,2),be=v=>{var $=st(),M=se($);D.Separator(M,{});var fe=J(M,2);D.Label(fe,{children:(F,_e)=>{Le(F,{size:1,color:"neutral",children:(Oe,dt)=>{var ye=q();Se(De=>Ce(ye,De),[()=>(n(),s(),O(()=>`Move to ${n()[s()].path}`))]),l(Oe,ye)},$$slots:{default:!0}})},$$slots:{default:!0}}),l(v,$)};le(V,v=>{s(),n(),O(()=>s()!==void 0&&n()[s()])&&v(be)}),l(W,X)},$$slots:{default:!0}}),l(U,ve)},$$slots:{default:!0},$$legacy:!0}),U=>c(S,U),()=>e(S))},Ee=E=>{{let U=ae(()=>(me(re),O(()=>[re.Hover])));he(ze(E,{get content(){return e(T)},get triggerOn(){return e(U)},side:"top",children:(Z,ve)=>{Ie(Z,{color:"neutral",variant:"soft",size:1,disabled:!0,children:(R,j)=>{var W=q("Rules");l(R,W)},$$slots:{default:!0,iconLeft:(R,j)=>{k(R,{slot:"iconLeft",name:"arrow-right"})},iconRight:(R,j)=>{k(R,{slot:"iconRight",name:"chevron-down"})}}})},$$slots:{default:!0},$$legacy:!0}),Z=>c(G,Z),()=>e(G))}};le(ue,E=>{e(g)?E(w):E(Ee,!1)}),l(o,u)};le(p,o=>{x(y,"$loading",r)||o(L)}),l(K,H),Ge(),N()}var rt=A('<div class="c-move-text-btn__left_icon svelte-1im2ez7"><!></div>'),lt=A('<div class="l-file-controls svelte-1im2ez7"><div class="l-file-controls-left svelte-1im2ez7"><div class="c-move-text-btn svelte-1im2ez7"><!></div> <div class="c-move-text-btn svelte-1im2ez7"><!></div></div> <div class="l-file-controls-right svelte-1im2ez7"><!></div></div>'),it=A('<div class="l-memories-editor svelte-1im2ez7"><div class="c-memories-editor__content svelte-1im2ez7"><!></div></div>');function bt(K,i){Te(i,!0);let n=$e(i,"text",15);const f=Je();let s=ne(""),r=ne(0),N=ne(0),I=ne("neutral");const g=async()=>{i.path&&(i.onSaveFile?await i.onSaveFile(n()):f.saveFile({repoRoot:"",pathName:i.path,content:n()}))},P=Ke();async function T(t){if(!e(s))return;let a,m,h;const d=e(s).slice(0,20);if(t==="userGuidelines"?(a="Move Content to User Guidelines",m=`Are you sure you want to move the selected content "${d}" to your user guidelines?`,h=pe.userGuidelines):t==="augmentGuidelines"?(a="Move Content to Workspace Guidelines",m=`Are you sure you want to move the selected content "${d}" to workspace guidelines?`,h=pe.augmentGuidelines):(a="Move Content to Rule",m=`Are you sure you want to move the selected content "${d}" to rule file "${t.rule.path}"?`,h=pe.rules),!await f.openConfirmationModal({title:a,message:m,confirmButtonText:"Move",cancelButtonText:"Cancel"}))return;t==="userGuidelines"?f.updateUserGuidelines(e(s)):t==="augmentGuidelines"?f.updateWorkspaceGuidelines(e(s)):(P(Ze({type:t.rule.type,path:t.rule.path,content:t.rule.content+`

`+e(s),description:t.rule.description,settingsStored:t.rule.settingsStored})),f.showNotification({message:`Moved content "${d}" to rule file "${t.rule.path}"`,type:"info",openFileMessage:{repoRoot:"",pathName:t.rule.path}}));const y=n().substring(0,e(r))+n().substring(e(N));return n(y),await g(),f.reportAgentSessionEvent({eventName:Ye.memoriesMove,conversationId:"",eventData:{memoriesMoveData:{target:h}}}),"success"}async function ie(t){await T({rule:t})}var B=it(),de=b(B),ce=b(de);Ve(ce,{saveFunction:g,get selectedText(){return e(s)},set selectedText(a){c(s,a,!0)},get selectionStart(){return e(r)},set selectionStart(a){c(r,a,!0)},get selectionEnd(){return e(N)},set selectionEnd(a){c(N,a,!0)},get value(){return n()},set value(a){n(a)},header:a=>{var m=lt(),h=b(m),d=b(h),y=b(d);{const C=p=>{var L=rt(),o=b(L),u=w=>{k(w,{name:"check"})},ue=w=>{k(w,{name:"arrow-right"})};le(o,w=>{e(I)==="success"?w(u):w(ue,!1)}),l(p,L)};let H=Me(()=>!e(s));je(y,{tooltip:{neutral:"Move highlighted text to user guidelines",success:"Text moved to user guidelines"},stateVariant:{success:"solid",neutral:"soft"},defaultColor:"neutral",onClick:()=>T("userGuidelines"),get disabled(){return e(H)},stickyColor:!1,persistOnTooltipClose:!0,replaceIconOnSuccess:!0,size:1,get state(){return e(I)},set state(p){c(I,p,!0)},iconLeft:C,children:(p,L)=>{var o=q("User Guidelines");l(p,o)},$$slots:{iconLeft:!0,default:!0}})}var Q=J(d,2),S=b(Q);{let C=Me(()=>!e(s));ot(S,{onRuleSelected:ie,get disabled(){return e(C)}})}var G=J(h,2),Y=b(G);Xe(Y,{size:1,get path(){return i.path},variant:"soft",onOpenLocalFile:async()=>(P(Qe({repoRoot:"",pathName:i.path})),"success"),$$slots:{text:(C,H)=>{Le(C,{slot:"text",size:1,children:(p,L)=>{var o=q("Augment-Memories.md");l(p,o)},$$slots:{default:!0}})}}}),l(a,m)},$$slots:{header:!0}}),l(K,B),Ge()}export{bt as M};
//# sourceMappingURL=MemoriesMarkdownEditor-Bw7euA9v.js.map
