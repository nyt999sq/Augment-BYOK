import{b5 as ja,aC as Wa,v as it,x as se,H as o,P as r,R as l,Q as f,N as t,B as lt,K as pe,L as S,a4 as Et,T as Me,ae as ne,S as $e,a7 as Be,a5 as za,J as _e,z as e,A as D,af as jt,ag as Va,Z as nt,F as n,y as mt,Y as Ot,w as yt,C as wt,D as Ge,aI as Pt,aK as Wt,_ as Ma,aO as Ka,X as $t,aG as ga,ak as ut,a3 as Lt,ar as _t,E as da,M as tt,I as Pe,aS as It,G as Rt,m as ue,V as Yt,a6 as Vt,ab as Te,O as ht,aj as Qt,as as ma,aa as Ye,b4 as Nt,ad as Ht,b0 as fa,b6 as _a,b1 as Ja}from"./Icon-CaBYD5oO.js";import{k as Ta}from"./key-CsCKik6T.js";import{c as Xa}from"./index-BBZh5tbU.js";import{R as At,S as Ya}from"./OpenFileButton-BnBhQVIy.js";import{A as Qa,S as Za,d as Zt,e as es,R as ts,D as as,I as Ut,f as ss,g as rs,h as ns,i as os,j as is,l as aa,k as ls,m as cs,n as ds,o as us,p as sa,q as Gt,P as qt,t as vs,c as ra,r as hs,C as ps}from"./main-panel-BWaqdbJR.js";import{t as Kt,s as gs,a as $a}from"./index-Ct3ef_qL.js";import{a as ms,C as fs}from"./Markdown-oTNiBtsM.js";import{I as xt,b as Jt}from"./IconButtonAugment-Rffikxkp.js";import{T as ot,a as pt,b as ba}from"./TextTooltipAugment-B4cqQh4H.js";import{E as _s,R as na,t as Bt,a as wa,b as $s}from"./AugmentMessage-BDJkLW0G.js";import{B as gt}from"./ButtonAugment-DECgcPdk.js";import{z as Na,a as ea,x as bs,b as ua,q as va,B as Ua,o as Ha,f as Oa,v as ws,i as ya,C as ys,G as Rs,H as kt,I as Ra,J as As,K as Ss,L as Aa,N as Cs,O as ks,P as Sa,Q as Ls,U as St,V as Ct,W as xs,X as Ds,Y as Bs,Z as Es,T as ia,D as He,_ as Ps,e as Ca,$ as Xt,a0 as Fs}from"./extension-client-context-CwKdOhUw.js";import{D as ka,M as Is,c as zs}from"./diff-operations-D1Km8fUV.js";import{d as La}from"./index-B4NDmpYR.js";import{n as Ms}from"./noop-CVINQ7cR.js";import{a as bt,R as oa}from"./index-nbgGMYE9.js";import{c as Ts}from"./utils-DpHtg3Qz.js";import{f as Ns}from"./marked.esm-CBEAPn3z.js";import{i as Us,b as Hs}from"./RemoteAgentStatusIndicator-qmKRPmeO.js";import{s as Os}from"./shared-app-state-BibCi4jI.js";import{b as Gs,B as xa}from"./types-CaiUesx9.js";import{g as Da,a as qs,K as js,P as Ws,R as Ba,A as Vs}from"./Keybindings-4dJzjBQT.js";import{E as Ks,C as Js}from"./message-broker-CliB7GoL.js";import{C as ta}from"./CalloutAugment-DfDZpfuE.js";import{C as Xs}from"./CopyButton-BCoIBrt5.js";import{b as Ys}from"./BaseTextInput-CPpF4fmq.js";import{T as Ea}from"./TextCombo-89YZbRHm.js";import{R as Qs,B as Zs}from"./RepoBadge-DexbRR0E.js";import"./remote-agents-client-DV0OXQaI.js";import"./SuccessfulButton-Df7hGnns.js";import"./design-system-init-DCR3FqZN.js";import"./index-DF_yYUtg.js";import"./await-bImbqfxU.js";import"./Chevron-Ct6H6suA.js";import"./shared-webview-store-model-BEcw7czj.js";import"./ra-diff-ops-model-Bh6ZhEmC.js";import"./Filespan-CzwbVFJm.js";import"./TextAreaAugment-BzfuWeQA.js";import"./toggleHighContrast-iCsKcMx3.js";import"./mermaid-Bezvo2Lx.js";import"./_commonjsHelpers-CwkBNZ52.js";import"./LanguageIcon-Du_otND8.js";import"./IconFilePath-BTkL5YPt.js";import"./next-edit-types-B8NR3rVy.js";import"./index-Dt79ugWJ.js";import"./keypress-fD7XHdyk.js";try{Ft=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},(pa=new Ft.Error().stack)&&(Ft._sentryDebugIds=Ft._sentryDebugIds||{},Ft._sentryDebugIds[pa]="cd6d475d-5aad-4471-a88e-085f9a9a4d37",Ft._sentryDebugIdIdentifier="sentry-dbid-cd6d475d-5aad-4471-a88e-085f9a9a4d37")}catch{}var Ft,pa;function la(Se){const a=Se.match(/github\.com\/([^/]+)\/([^/]+?)(?:\.git|\/|$)/);if(a)return{owner:a[1],name:a[2]}}function Ga(Se){const a=Se.match(/^[^/]+\/HEAD\s*->\s*(.+)$/);if(a)return Ga(a[1]);const s=function(g){const C=g.match(/^refs\/remotes\/([^/]+)\/(.+)$/);if(C)return{remote:C[1],branch:C[2]};const i=g.match(/^([^/]+)\/(.+)$/);if(i){const[,v,z]=i;if(["origin","upstream","fork","github","gitlab","bitbucket"].includes(v)||v.includes("."))return{remote:v,branch:z}}return null}(Se);return s?s.branch:Se}var er=o('<div class="c-agent-edits-header__summary"><!></div>'),tr=o('<!> <span class="c-agent-edits-header__revert-btn__text">Discard All</span>',1),ar=o('<!> <span class="c-agent-edits-header__accept-btn__text">Keep All</span>',1),sr=o('<div class="c-agent-edits-header__actions"><!> <!> <!></div>'),rr=o('<div class="c-agent-edits-header svelte-14lt18i"><div class="c-agent-edits-header__content"><div class="c-agent-edits-header__collapse-btn"><!></div> <div class="c-agent-edits-header__info-container"><!></div> <!></div> <!></div>');function nr(Se,a){it(a,!0);let s=se(a,"onRevert",19,()=>{}),g=se(a,"onKeep",19,()=>{});var C=rr(),i=r(C),v=r(i),z=r(v);ms(z,{});var W=l(v,2),w=r(W),H=Q=>{var N=pe(),ve=S(N);Et(ve,()=>a.text),t(Q,N)},de=Q=>{Me(Q,{size:1,color:"neutral",truncate:!0,children:(N,ve)=>{var oe=ne();$e(c=>Be(oe,`${c??""} changed`),[()=>Na(a.filesCount,"file")]),t(N,oe)},$$slots:{default:!0}})};f(w,Q=>{a.text?Q(H):Q(de,!1)});var ie=l(W,2),ce=Q=>{var N=er(),ve=r(N);_s(ve,{size:0,get totalAddedLines(){return a.diffSummary.totalAddedLines},get totalRemovedLines(){return a.diffSummary.totalRemovedLines}}),t(Q,N)};f(ie,Q=>{a.hasChanges&&Q(ce)});var ge=l(i,2),he=Q=>{var N=sr(),ve=r(N),oe=y=>{gt(y,{class:"c-agent-edits-header__revert-btn",variant:"soft",color:"neutral",size:.5,$$events:{click(...E){s()?.apply(this,E)}},children:(E,R)=>{{let F=D(()=>[pt.Hover]);ot(E,{get triggerOn(){return e(F)},content:"Discard all changes",children:(L,x)=>{var P=tr(),m=S(P);_e(m,{name:"undo-2"}),t(L,P)},$$slots:{default:!0}})}},$$slots:{default:!0}})};f(ve,y=>{s()&&y(oe)});var c=l(ve,2),U=y=>{gt(y,{class:"c-agent-edits-header__accept-btn",variant:"soft",color:"success",size:.5,$$events:{click(...E){g()?.apply(this,E)}},children:(E,R)=>{{let F=D(()=>[pt.Hover]);ot(E,{get triggerOn(){return e(F)},content:"Keep all changes and clear checkpoints",children:(L,x)=>{var P=ar(),m=S(P);_e(m,{name:"check-check"}),t(L,P)},$$slots:{default:!0}})}},$$slots:{default:!0}})};f(c,y=>{g()&&y(U)});var T=l(c,2);Et(T,()=>a.actions??za),t(Q,N)};f(ge,Q=>{(a.collapsed&&a.hasChanges&&(s()||g())||a.actions)&&Q(he)}),t(Se,C),lt()}var or=o('<div class="c-edit"><!></div>'),ir=o("<span>Show less</span> <!>",1),lr=o("<span> </span> <!>",1),cr=o('<div class="c-show-more-container svelte-1vu2yno"><!></div>'),dr=o('<div class="c-edits-list svelte-1vu2yno"><div class="c-edits-section svelte-1vu2yno"><!> <!></div></div>'),ur=o('<div class="c-agent-edits-header__buttons__text--long svelte-1vu2yno">See full diff</div> <div class="c-agent-edits-header__buttons__text--short svelte-1vu2yno"><!></div>',1),vr=o('<div class="c-agent-edits-header__actions svelte-1vu2yno"><div class="c-agent-edits-header__actions__count"> </div> <div class="c-agent-edits-header__buttons svelte-1vu2yno"><!></div></div>'),hr=o('<div class="c-agent-edits-container svelte-1vu2yno"><!></div>'),pr=o('<div class="c-edits-list c-edits-list--empty svelte-1vu2yno"><!></div>');function gr(Se,a){it(a,!0);let s=se(a,"changedFiles",19,()=>[]),g=se(a,"collapsed",7,!1),C=se(a,"focusedFilePath",3,null),i=se(a,"emptyMessage",3,"No changes to show");const v=ea();let z=nt(!1);function W(){n(z,!e(z))}let w=[],H=D(()=>{const oe=s().map(c=>{const U=ka.generateDiff(c.old_path,c.new_path,c.old_contents||"",c.new_contents||""),T=ka.getDiffObjectStats(U),y={totalAddedLines:T.additions,totalRemovedLines:T.deletions};return{file:c,qualifiedPathName:{rootPath:"",relPath:c.new_path||c.old_path},changesSummary:y}}).filter(c=>c.changesSummary.totalAddedLines>0||c.changesSummary.totalRemovedLines>0);return La(oe,w)?w:(w=oe,oe)}),de={totalAddedLines:0,totalRemovedLines:0},ie=D(()=>{const oe=e(H).reduce((c,U)=>(c.totalAddedLines+=U.changesSummary.totalAddedLines,c.totalRemovedLines+=U.changesSummary.totalRemovedLines,c),{totalAddedLines:0,totalRemovedLines:0});return La(oe,de)?de:(de=oe,oe)}),ce=D(()=>e(H).length>3),ge=D(()=>s().length>zs);var he=pe(),Q=S(he),N=oe=>{var c=hr(),U=r(c);fs(U,{class:"c-agent-edits-container__block-container",get collapsed(){return g()},set collapsed(T){g(T)},children:(T,y)=>{var E=dr(),R=r(E),F=r(R);jt(F,17,()=>e(z)?e(H):e(H).slice(0,3),Va,(P,m)=>{const I=D(()=>C()===e(m).file.new_path||C()===e(m).file.old_path);var V=or(),J=r(V);{const ee=te=>{var O=pe(),_=S(O),d=$=>{ot($,{content:"Toggle collapse unchanged regions",children:(u,A)=>{xt(u,{color:"neutral",size:.5,variant:"ghost-block",$$events:{click:h=>{h.stopPropagation(),v.toggleCollapseUnchangedRegions()}},children:(h,B)=>{_e(h,{name:"layers-2",size:1})},$$slots:{default:!0}})},$$slots:{default:!0}})};f(_,$=>{e(I)&&$(d)}),t(te,O)};let b=D(()=>a.onFileClick?()=>a.onFileClick(e(m).file.new_path||e(m).file.old_path):void 0),p=D(()=>a.onReviewClick?()=>a.onReviewClick(e(m).file):void 0),q=D(()=>a.onRevertClick?()=>a.onRevertClick(e(m).file):void 0);Qa(J,{get qualifiedPathName(){return e(m).qualifiedPathName},get lineChanges(){return e(m).changesSummary},get isFocused(){return e(I)},get onClickFile(){return e(b)},get onClickReview(){return e(p)},get onClickRevert(){return e(q)},actions:ee,$$slots:{actions:!0}})}Kt(3,V,()=>gs),t(P,V)});var L=l(F,2),x=P=>{var m=cr(),I=r(m);gt(I,{color:"neutral",size:1,variant:"soft",$$events:{click:W},children:(V,J)=>{var ee=pe(),b=S(ee),p=te=>{var O=ir(),_=l(S(O),2);_e(_,{name:"chevron-up",slot:"iconRight"}),t(te,O)},q=te=>{const O=D(()=>e(H).length-3);var _=lr(),d=S(_),$=r(d),u=l(d,2);_e(u,{name:"chevron-down",slot:"iconRight"}),$e(A=>Be($,`Show ${e(O)??""} more ${A??""}`),[()=>bs(e(O),"file")]),t(te,_)};f(b,te=>{e(z)?te(p):te(q,!1)}),t(V,ee)},$$slots:{default:!0}}),t(P,m)};f(L,P=>{e(ce)&&P(x)}),t(T,E)},$$slots:{default:!0,header:(T,y)=>{nr(T,{get filesCount(){return e(H).length},get diffSummary(){return e(ie)},get collapsed(){return g()},hasChanges:!0,slot:"header",text:R=>{var F=vr(),L=r(F),x=r(L),P=l(L,2),m=r(P);{let I=D(()=>e(ge)?Is:void 0);ot(m,{get content(){return e(I)},children:(V,J)=>{gt(V,{color:"neutral",size:.5,variant:"soft",get disabled(){return e(ge)},$$events:{click(...ee){(a.onOpenDiffView||Ms)?.apply(this,ee)}},children:(ee,b)=>{var p=ur(),q=l(S(p),2),te=r(q);_e(te,{name:"file-diff",size:1}),t(ee,p)},$$slots:{default:!0}})},$$slots:{default:!0}})}$e(I=>Be(x,`${I??""} changed`),[()=>Na(e(H).length,"file")]),t(R,F)},$$slots:{text:!0}})}}}),t(oe,c)},ve=oe=>{var c=pr(),U=r(c);Me(U,{size:1,color:"neutral",children:(T,y)=>{var E=ne();$e(()=>Be(E,i())),t(T,E)},$$slots:{default:!0}}),t(oe,c)};f(Q,oe=>{e(H).length>0?oe(N):oe(ve,!1)}),t(Se,he),lt()}var mr=o('<div class="c-agent-footer__button svelte-59regt"><!></div>'),fr=o('<div class="c-agent-footer__button svelte-59regt"><!></div>'),_r=o('<div class="c-agent-footer__buttons svelte-59regt"><!> <!></div>'),$r=o('<div class="c-agent-footer svelte-59regt"><div class="c-agent-footer__status svelte-59regt"><!></div> <!></div>'),br=o(`Augment needs to modify your SSH configuration at <code>~/.ssh/config</code> to connect to the
        remote workspace. This will:`,1),wr=o('<div class="c-ssh-permission-modal__body svelte-59regt"><!> <!> <!> <!> <!></div>'),yr=o('<div class="c-ssh-permission-modal__footer svelte-59regt"><!> <!></div>'),Rr=o("<!> <!>",1);function Ar(Se,a){it(a,!0);const s=()=>Ge(i,"$remoteAgentsModel",g),[g,C]=wt(),i=mt(At.key),v=mt(Za),z=mt(Zt.key),W=yt(""),w=Us(W);let H=nt(!0),de=nt(!1);Ot(async()=>{n(H,await i.getShouldShowSSHConfigPermissionPrompt(),!0);try{const{remoteUrl:p,error:q}=await z.getRemoteUrl();if(q)throw new Error(q);W.set(p)}catch(p){console.error("Failed to get current repository URL:",p)}});let ie=nt(!1),ce=nt(0),ge=D(()=>e(ce)>660),he=D(()=>s()?.currentAgent),Q=D(()=>e(he)?.remote_agent_id),N=D(()=>s()?.isCurrentAgentDetailsLoading);function ve(){e(H)?n(de,!0):oe()}function oe(){e(Q)&&(n(T,!0),async function(p){if(!p)return;const q=i.agentOverviews.find(te=>te.remote_agent_id===p);q&&await i.sshToRemoteAgent(q)}(e(Q)).then(()=>{n(T,!1)}))}async function c(){n(de,!1);try{await i.setPermissionToWriteToSSHConfig(!0)}catch(p){console.error("Failed to set SSH permission:",p)}oe()}function U(){n(de,!1)}let T=nt(!1),y=D(()=>Ts(s().currentConversation?.exchanges??[])),E=D(()=>s().focusedFilePath),R=D(()=>s().isRemoteAgentSshWindow);const F=ua();let L=D(()=>e(R)?p=>{F(Ha({repoRoot:"",pathName:p}))}:void 0);async function x(p){const q=p.new_path||p.old_path;s().openDiffInBuffer(p.old_contents||"",p.new_contents||"",q)}const P=va(),m=Ua(P);function I(){s().currentAgent?.remote_agent_id?(i.reportRemoteAgentEvent({eventName:Oa.createdPR,remoteAgentId:s().currentAgent.remote_agent_id,eventData:{createdPRData:{}}}),n(ie,!0),s().sendMessage("Please create a pull request with the changes you've made.",Ge(m,"$selectedModelId",g)??void 0).then(()=>{n(ie,!1)}).catch(p=>{console.error("Error sending PR creation request:",p),n(ie,!1)})):console.error("No current agent ID found")}var V=Rr(),J=S(V),ee=p=>{var q=$r(),te=r(q),O=r(te),_=u=>{{let A=D(()=>!e(ge)),h=D(()=>e(N)?"Loading...":"No changes to show");gr(u,{get changedFiles(){return e(y)},get collapsed(){return e(A)},get focusedFilePath(){return e(E)},get emptyMessage(){return e(h)},onReviewClick:x,onOpenDiffView:()=>{v.set(-1),s().showRemoteAgentDiffPanel({turnIdx:-1,changedFiles:e(y),userPrompt:"",sessionSummary:"",isShowingAggregateChanges:!0,isAgentFromDifferentRepo:Ge(w,"$isAgentFromDifferentRepo",g)(e(he))})},get onFileClick(){return e(L)}})}};f(O,u=>{e(y).length>0&&u(_)});var d=l(te,2),$=u=>{var A=_r(),h=r(A),B=k=>{var Y=mr(),ae=r(Y);{let K=D(()=>[pt.Hover]);ot(ae,{get triggerOn(){return e(K)},content:"Create a GitHub pull request with the changes",children:(G,Ke)=>{{let Le=D(()=>[bt.agentUnspecified,bt.agentPending,bt.agentStarting].includes(e(he)?.status));gt(G,{size:2,variant:"soft",color:"neutral",onclick:I,class:"c-agent-footer__open-btn",get disabled(){return e(Le)},children:(xe,Fe)=>{var je=pe(),Ee=S(je),qe=M=>{var be=ne("Creating a PR...");t(M,be)},j=M=>{var be=ne("Create a PR");t(M,be)};f(Ee,M=>{e(ie)?M(qe):M(j,!1)}),t(xe,je)},$$slots:{default:!0,iconRight:(xe,Fe)=>{_e(xe,{slot:"iconRight",name:"git-pull-request"})}}})}},$$slots:{default:!0}})}t(k,Y)};f(h,k=>{e(y).length>0&&k(B)});var X=l(h,2),Ae=k=>{var Y=fr(),ae=r(Y);{let K=D(()=>[pt.Hover]);ot(ae,{get triggerOn(){return e(K)},content:"SSH into the remote agent's workspace in a new VSCode window",children:(G,Ke)=>{{const Le=Fe=>{var je=pe(),Ee=S(je),qe=M=>{Pt(M,{size:1,useCurrentColor:!0})},j=M=>{_e(M,{name:"external-link"})};f(Ee,M=>{e(T)?M(qe):M(j,!1)}),t(Fe,je)};let xe=D(()=>[bt.agentUnspecified,bt.agentPending,bt.agentStarting].includes(e(he)?.status)||e(T));gt(G,{size:2,variant:"soft",color:"accent",onclick:ve,class:"c-agent-footer__open-btn",get disabled(){return e(xe)},iconRight:Le,children:(Fe,je)=>{var Ee=pe(),qe=S(Ee),j=be=>{var Je=ne("Connecting...");t(be,Je)},M=be=>{var Je=ne("Open remote workspace");t(be,Je)};f(qe,be=>{e(T)?be(j):be(M,!1)}),t(Fe,Ee)},$$slots:{iconRight:!0,default:!0}})}},$$slots:{default:!0}})}t(k,Y)};f(X,k=>{e(R)||k(Ae)}),t(u,A)};f(d,u=>{e(Q)&&!e(R)&&u($)}),t(p,q)};f(J,p=>{e(he)&&p(ee)});var b=l(J,2);Ns(b,{get show(){return e(de)},title:"SSH Configuration Permission",oncancel:U,body:te=>{var O=wr(),_=r(O);Me(_,{size:1,children:(h,B)=>{var X=br();t(h,X)},$$slots:{default:!0}});var d=l(_,2);Me(d,{size:1,children:(h,B)=>{var X=ne("• Create or update SSH configuration files");t(h,X)},$$slots:{default:!0}});var $=l(d,2);Me($,{size:1,children:(h,B)=>{var X=ne("• Add connection settings for the remote agent");t(h,X)},$$slots:{default:!0}});var u=l($,2);Me(u,{size:1,children:(h,B)=>{var X=ne("• Enable secure access to your remote workspace");t(h,X)},$$slots:{default:!0}});var A=l(u,2);Me(A,{size:1,children:(h,B)=>{var X=ne("• Your existing SSH configuration will be preserved.");t(h,X)},$$slots:{default:!0}}),t(te,O)},footer:te=>{var O=yr(),_=r(O);gt(_,{variant:"solid",color:"neutral",onclick:U,children:($,u)=>{var A=ne("Cancel");t($,A)},$$slots:{default:!0}});var d=l(_,2);gt(d,{variant:"solid",color:"accent",onclick:c,children:($,u)=>{var A=ne("Allow & Connect");t($,A)},$$slots:{default:!0}}),t(te,O)},$$slots:{body:!0,footer:!0}}),function(p,q){ja(window,["resize"],()=>Wa(()=>q(window[p])))}("innerHeight",p=>n(ce,p,!0)),t(Se,V),lt(),C()}var Sr=o("<span>Add context <!></span>"),Cr=o('<div class="c-chat-input__context-bar svelte-18c6ign"><!></div>'),kr=o('<span class="character-counter svelte-18c6ign"> </span>'),Lr=o("<!> <!>",1),xr=o("<!> <div><!></div>",1),Dr=o("<span>Cancel <!></span>"),Br=o("<!> <!> <!> <!> <!>",1),Er=o("<div><!></div>"),Pr=o("<!> <!>",1),Fr=o("<!> <!> <!> <!> <!> <!> <!> <!>",1),Ir=o('<div class="c-chat-input svelte-18c6ign" data-testid="design-system-chat-input"><!></div>');function Pa(Se,a){it(a,!0);const s=()=>Ge(ie,"$remoteAgentsModel",z),g=()=>Ge(N,"$draft",z),C=()=>Ge(he,"$enableChatInputInlineCompletion",z),i=()=>Ge(oe,"$selectedModelId",z),v=()=>Ge(ge,"$enableChatMultimodal",z),[z,W]=wt(),w=ua(),H=ea(),de=ws(),ie=mt(At.key);if(!ie||!s())throw new Error("Remote model is not available");const ce=mt(Zt.key),ge=ya("enableChatMultimodal"),he=ya("enableChatInputInlineCompletion"),Q=va(),N=ys(),ve=D(()=>g()?.exchange),oe=Rs(),c=ce?.currentRepositoryUrl,U=Z=>{H.showNotification({message:Z,type:"error"})},T=D(()=>os(s()));let y=se(a,"editable",3,!0),E=se(a,"placeholder",3,"Ask or instruct Augment"),R=se(a,"hasSendButton",3,!0),F=se(a,"richTextEditorRoot",15),L=nt(void 0),x=nt(!1);const P=D(()=>!s()?.currentAgentId),m=Wt(async()=>{if(!e(x)&&e(P))try{await ie.reportRemoteAgentSetupWindowEvent(kt.typeInPromptWindow),n(x,!0)}catch(Z){console.error("Failed to report type in prompt window event:",Z)}},1500),I=D(()=>new is(de.store,H));let V=nt(void 0);const J=Wt(async()=>{const Z=F()?.getEditor?.();if(!Z)return;const De=Da(Z.state,`
`,aa),Ce=qs(Z.state,`
`,aa),me=De.prefix,fe=Ce.suffix;if(!me||me.length<3)return;const Re=await e(I).getCompletion(me,fe),le=Da(Z.state,`
`,aa);De.prefix===le.prefix&&Re&&e(V)?.showCompletion(Re,me)},200),ee={type:"doc",content:[{type:"paragraph"}]};function b(Z){w(ks({draftStatus:Sa.ready,exchange:{...e(ve)||{},request_message:Z.rawText,rich_text_json_repr:Z.richTextJsonRepr||ee,status:Ks.draft}})),C()&&e(V)&&(e(V)?.hasActiveCompletion?.()||(J.cancel(),J())),Z.rawText&&Z.rawText.trim().length>0&&m()}function p(Z){w(Ls(Z.current))}let q;Ma(()=>{const Z=s()?.currentAgent?.status;q!==bt.agentStarting||Z!==bt.agentRunning&&Z!==bt.agentIdle||Ka().then(()=>K()),q=Z});const te=D(()=>s()?us(w,i(),e(ve),v(),s(),ce,F()):{isDisabled:!0,disabledReason:"No remote agent model available",showCancelButton:!1,action:()=>!1,cancelAction:()=>{}}),O=D(()=>e(te).showCancelButton),_=D(()=>e(ve)?.request_message?.length||0),d=D(()=>e(te).isDisabled),$=D(()=>e(te).disabledReason),u=D(()=>{return Z=e(te).action,()=>{const De=Z();return De&&w(Bs()),De};var Z}),A=D(()=>e(te).cancelAction),h=D(()=>`remote-${s()?.isActive}-${E()}`),B=()=>{F()?.isFocused===void 0||_t(F().isFocused())||ls()||F().requestFocus()},X=async()=>!e(d)&&(w(St(Ct.WEBVIEW.SEND_ACTION_TRIGGERED,{source:"keybinding"})),e(u)()),Ae=Z=>{w(St(Ct.WEBVIEW.CANCEL_ACTION_TRIGGERED,{source:Z}))},k=async()=>e(O)?(Ae("keybinding"),e(A)()):G();let Y=nt(void 0);const ae=()=>F()?.requestFocus(),K=()=>F()?.forceFocus?.(),G=()=>(F()?.blur(),!0);let Ke=E();const Le=D(()=>cs(s(),Ge(c,"$currentRepoUrl",z),e(d))),xe=D(()=>s()&&s().generateSetupScriptSelected),Fe=crypto.randomUUID();function je(){w(xs(Fe))}function Ee(Z,De){for(const Ce of Z)w(St(Ct.SHARED.FILE_ATTACHMENT_SUCCEEDED,{bytes:Ce.size,type:Ce.type?Ce.type:"unknown"}));for(const Ce of De)w(St(Ct.SHARED.FILE_ATTACHMENT_FAILED,{bytes:Ce.files[0].size,type:Ce.files[0].type?Ce.files[0].type:"unknown"}));w(St(Ct.SHARED.FILE_ATTACHMENT_BUNDLE_COMPLETED,{successes:Z.length,failures:De.length}))}function qe(){w(St(Ct.SHARED.FILE_ATTACHMENT_STARTED,{source:"drop"}))}function j(){w(St(Ct.SHARED.FILE_ATTACHMENT_STARTED,{source:"button"}))}function M(Z){w(St(Ct.WEBVIEW.CONTEXT_MENU_BUTTON_CLICKED,{source:Z}))}var be=Ir();$t("blur",ga,()=>w(Ra())),$t("beforeunload",ga,()=>w(Ra()));var Je=r(be);As(Je,{scope:"chat-input",children:(Z,De)=>{var Ce=pe(),me=S(Ce);Ta(me,()=>e(h),fe=>{var Re=pe(),le=S(Re);{const ke=Xe=>{var re=pe(),we=S(re);Et(we,()=>a.banner??za),t(Xe,re)},rt=Xe=>{var re=pe(),we=S(re),We=Ne=>{var Ue=Cr(),Ve=r(Ue);ss(Ve,{prepend:Qe=>{var Ze=pe(),st=S(Ze),ct=dt=>{var Dt=pe(),zt=S(Dt);{const Mt=ze=>{var Oe=Sr(),vt=l(r(Oe));wa(vt,{commandName:"openContextMenu",keysOnly:!0}),t(ze,Oe)};let ye=D(()=>e(Y)?.insertMentionNode);ut(zt,()=>Ut.ContextMenu,(ze,Oe)=>{Oe(ze,{onCloseDropdown:ae,get onInsertMentionable(){return e(ye)},trackButtonClick:M,tooltipContent:Mt,$$slots:{tooltipContent:!0}})})}t(dt,Dt)};f(st,dt=>{e(T).doHideAtMentions||dt(ct)}),t(Qe,Ze)},$$slots:{prepend:!0}}),t(Ne,Ue)};f(we,Ne=>{e(T).doHideContextBar||Ne(We)}),t(Xe,re)},at=Xe=>{var re=Er(),we=r(re);{const We=Ue=>{var Ve=Lr(),Ie=S(Ve),Qe=st=>{var ct=kr(),dt=r(ct);$e(()=>Be(dt,`${e(_)??""}/${Aa}`)),t(st,ct)};f(Ie,st=>{e(_)>Aa&&st(Qe)});var Ze=l(Ie,2);rs(Ze,{get selectedModelId(){return i()},onModelChange:st=>{Ge(Q,"$currentConversationId",z)&&w(Cs(st||void 0))}}),t(Ue,Ve)},Ne=Ue=>{var Ve=Br(),Ie=S(Ve),Qe=ye=>{var ze=pe(),Oe=S(ze);{let vt=D(Ds);ut(Oe,()=>Ut.AddFileButton,(et,ft)=>{ft(et,{get accept(){return e(vt)},onClick:j})})}t(ye,ze)};f(Ie,ye=>{v()&&!e(T).doHideMultimodalActions&&ye(Qe)});var Ze=l(Ie,2),st=ye=>{var ze=xr(),Oe=S(ze);ns(Oe,{get draft(){return g()},forceEditorFocus:K,get editorContainer(){return e(L)}});var vt=l(Oe,2),et=r(vt);{let ft=D(()=>g()?.draftStatus===Sa.enhancing);ut(et,()=>Ut.RewritePromptButton,(Tt,qa)=>{qa(Tt,{onRewrite:je,get isDisabled(){return e(Le).isDisabled},get disabledReason(){return e(Le).disabledReason},get isEnhancing(){return e(ft)}})})}Kt(3,vt,()=>Os,()=>({axis:"x",duration:200,scale:.4})),t(ye,ze)};f(Ze,ye=>{e(O)||e(Le).isHidden||ye(st)});var ct=l(Ze,2);Gs(ct,{color:"premium",size:1,variant:"soft",children:(ye,ze)=>{var Oe=ne("Beta");t(ye,Oe)},$$slots:{default:!0}});var dt=l(ct,2);{let ye=D(()=>!e(O));na(dt,{get isDisabled(){return e(ye)},name:"cancelGeneration",debounce:!0,handler:k})}var Dt=l(dt,2),zt=ye=>{var ze=pe(),Oe=S(ze);{const vt=et=>{var ft=Dr(),Tt=l(r(ft));wa(Tt,{commandName:"cancelGeneration",keysOnly:!0}),t(et,ft)};ut(Oe,()=>Ut.CancelButton,(et,ft)=>{ft(et,{get cancelAction(){return e(A)},onAnalyticsTrack:Ae,tooltipContent:vt,$$slots:{tooltipContent:!0}})})}t(ye,ze)},Mt=ye=>{var ze=pe(),Oe=S(ze),vt=et=>{ds(et,{get isDisabled(){return e(d)},get disabledReason(){return e($)},get sendAction(){return e(u)}})};f(Oe,et=>{R()&&et(vt)},!0),t(ye,ze)};f(Dt,ye=>{e(O)?ye(zt):ye(Mt,!1)}),t(Ue,Ve)};ut(we,()=>Ut.Root,(Ue,Ve)=>{Ve(Ue,{leftAlign:We,rightAlign:Ne,$$slots:{leftAlign:!0,rightAlign:!0}})})}t(Xe,re)};ut(le,()=>Ba.Root,(Xe,re)=>{Lt(re(Xe,{get editable(){return y()},variant:"default",get showActionButton(){return e(xe)},get activeButton(){return a.activeButton},banner:ke,header:rt,footer:at,children:(we,We)=>{var Ne=Fr(),Ue=S(Ne);na(Ue,{name:"focusChatInput",handler:B});var Ve=l(Ue,2);na(Ve,{name:"sendChatAction",debounce:!0,handler:X});var Ie=l(Ve,2);js(Ie,{shortcuts:{Enter:(ye,ze,Oe)=>(Bt("enter"),!0),"Meta-Enter":(ye,ze,Oe)=>(Bt("command+enter"),!0),"Control-Enter":(ye,ze,Oe)=>(Bt("ctrl+enter"),!0),Escape:(ye,ze,Oe)=>(console.error("SHOLD TRIGGER","ESCAPE"),Bt("escape"),!0),"Alt-Enter":(ye,ze,Oe)=>(Bt("option+enter"),!0),"Meta-Shift-Backspace":(ye,ze,Oe)=>(Bt("command+shift+backspace"),!0),"Meta-Shift-Enter":(ye,ze,Oe)=>(Bt("command+shift+enter"),!0)}});var Qe=l(Ie,2),Ze=ye=>{Lt(Vs(ye,{requestEditorFocus:ae,onMentionItemsUpdated:p}),ze=>n(Y,ze,!0),()=>e(Y))};f(Qe,ye=>{e(T).doHideAtMentions||ye(Ze)});var st=l(Qe,2),ct=ye=>{var ze=pe(),Oe=S(ze);ut(Oe,()=>es.Root,(vt,et)=>{Lt(et(vt,{onBeforeCompletionAccepted:(ft,Tt)=>e(I).handleInlineCompletionAccepted(ft,Tt,e(Y)),onCompletionAccepted:()=>e(I).reportCompletionAccepted(),onCompletionRejected:()=>e(I).reportCompletionRejected()}),ft=>n(V,ft,!0),()=>e(V))}),t(ye,ze)};f(st,ye=>{C()&&ye(ct)});var dt=l(st,2);Ws(dt,{get placeholder(){return Ke}});var Dt=l(dt,2);{let ye=D(()=>e(ve)?.rich_text_json_repr||ee);ut(Dt,()=>Ba.Content,(ze,Oe)=>{Oe(ze,{get content(){return e(ye)},onContentChanged:b})})}var zt=l(Dt,2),Mt=ye=>{var ze=Pr(),Oe=S(ze);ts(Oe,{saveImage:(...et)=>H.saveImage(...et),saveAttachment:(...et)=>H.saveAttachment(...et),deleteImage:(...et)=>H.deleteImage(...et),renderImage:(...et)=>H.loadImage(...et),get maxImages(){return Ss},supportedFileTypes:["image","text"],onValidationError:U,onCompletedAttachment:Ee});var vt=l(Oe,2);as(vt,{onDrop:qe}),t(ye,ze)};f(zt,ye=>{v()&&!e(T).doHideMultimodalActions&&ye(Mt)}),t(we,Ne)},$$slots:{banner:!0,header:!0,footer:!0,default:!0}}),we=>F(we),()=>F())})}t(fe,Re)}),t(Z,Ce)},$$slots:{default:!0}}),Lt(be,Z=>n(L,Z),()=>e(L)),t(Se,be),lt(),W()}var zr=o('<span class="view-icon svelte-1pxjepz"><!></span>'),Mr=o('<div class="version-navigation svelte-1pxjepz"><!> <!> <!></div>'),Tr=o('<div class="header-content__actions"><!></div>'),Nr=o('<div class="dropdown-item-content svelte-1pxjepz"><!> <!></div>'),Ur=o('<div class="dropdown-item-content svelte-1pxjepz"><!> <!></div>'),Hr=o("<!> <!>",1),Or=o("<!> <!>",1),Gr=o('<div class="error-message svelte-1pxjepz"><!></div>'),qr=o('<div class="setup-script-save-bar svelte-1pxjepz"><div class="header-content svelte-1pxjepz"><div class="header-content__title svelte-1pxjepz"><!> <!></div> <div class="header-content__title svelte-1pxjepz"><!> <!></div></div> <div class="save-bar-content svelte-1pxjepz"><!> <!> <!> <!> <div class="input-group location-buttons svelte-1pxjepz"><!></div> <!></div></div>');function jr(Se,a){it(a,!0);const s=()=>Ge(i,"$remoteAgentsModel",g),[g,C]=wt(),i=mt(At.key);let v=nt("setup.sh"),z=nt("home"),W=nt(!1),w=nt(""),H=nt(0),de=D(()=>function(y){return!y||!Array.isArray(y)?[]:y.flatMap(E=>(E.exchange.response_nodes||[]).filter(R=>R.type===Js.TOOL_USE&&R.tool_use?.tool_name==="setup-script"&&R.tool_use?.input_json).map(R=>{try{const F=typeof R.tool_use.input_json=="string"?JSON.parse(R.tool_use.input_json):R.tool_use.input_json,L=s().getToolUseState(R.tool_use.tool_use_id),x=E.exchange?.request_id||E.request_id||"";return x||console.warn("SetupScriptSaveBar: Missing request_id for an exchange",E),{content:F.script_content||"",timestamp:R.timestamp,status:L.phase,requestId:x,id:R.tool_use.tool_use_id}}catch(F){return console.error("Failed to parse setup script JSON:",F),null}})).filter(E=>E!==null&&E.content!=="")}(s().currentConversation?.exchanges||[])),ie=D(()=>e(de).length);Ma(()=>{e(ie)&&n(H,e(ie)-1)});let ce=D(()=>e(de)[e(H)]);const ge=va(),he=Es(ge),Q=Ua(ge),N=ea();function ve(y=1){n(H,Math.max(0,Math.min(e(de).length-1,e(H)+y)),!0);const E=e(de)[e(H)];E?.id&&Ps(E.id)}async function oe(y){if(e(v)&&y)if(e(ce)?.content)try{n(W,!0),n(w,"");const E=e(v).endsWith(".sh")?e(v):`${e(v)}.sh`,R=await i.saveSetupScript(E,e(ce).content,y);let F;if(!R.success||!R.path)return void n(w,R.error||"Failed to save setup script",!0);if(F=(await i.listSetupScripts()).find(I=>I.path===R.path),!F)return void n(w,"Failed to save script");const L=s()?.currentAgent,x=L?.workspace_setup?.starting_files?.github_commit_ref?.git_ref,P=L?.workspace_setup?.starting_files?.github_commit_ref?.repository_url;await i.saveLastRemoteAgentSetup(P||null,x||null,R.path),Ya||i.setCurrentAgent(void 0);const m=Ge(he,"$draftExchange",g)?.exchange.request_message;if(m&&m.trim())try{if(L?.workspace_setup?.starting_files?.github_commit_ref&&x&&P){const I=L.workspace_setup.starting_files,V={commitRef:I,selectedBranch:{name:x,commit:{sha:"",url:""},protected:!1},setupScript:F,isDisabled:!1,enableNotification:!0,isSetupScriptAgent:!1};i.setNewAgentDraft(V);const J=await i.createRemoteAgentFromDraft(m,Ge(Q,"$selectedModelId",g)??void 0);J?await i.setCurrentAgent(J):n(w,"Script saved successfully, but failed to create remote agent")}else n(w,"Script saved successfully, but no workspace information available to create remote agent")}catch(I){console.error("Failed to create remote agent:",I),n(w,"Script saved successfully, but failed to create remote agent")}else i.setCurrentAgent(void 0)}catch(E){n(w,E instanceof Error?E.message:"Unknown error occurred",!0)}finally{n(W,!1)}else n(w,"No script content to save");else n(w,"Please provide both script name and location")}var c=pe(),U=S(c),T=y=>{var E=qr(),R=r(E),F=r(R),L=r(F);Me(L,{size:1,weight:"medium",children:(A,h)=>{var B=ne("Setup script");t(A,B)},$$slots:{default:!0}});var x=l(L,2);ot(x,{content:"View full script in editor",side:"bottom",children:(A,h)=>{gt(A,{variant:"ghost-block",color:"neutral",size:1,onclick:()=>{N.openScratchFile(e(ce)?.content,"shellscript")},iconLeft:X=>{var Ae=zr(),k=r(Ae);_e(k,{name:"external-link"}),t(X,Ae)},children:(X,Ae)=>{var k=ne("View");t(X,k)},$$slots:{iconLeft:!0,default:!0}})},$$slots:{default:!0}});var P=l(F,2),m=r(P),I=A=>{var h=Mr(),B=r(h);{let k=D(()=>e(H)===0?"":"Switch to previous script"),Y=D(()=>[pt.Hover]);ot(B,{get content(){return e(k)},get triggerOn(){return e(Y)},children:(ae,K)=>{{let G=D(()=>e(H)===0);xt(ae,{variant:"ghost-block",size:1,onclick:()=>ve(-1),get disabled(){return e(G)},title:"Previous version",children:(Ke,Le)=>{_e(Ke,{name:"chevron-left"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}var X=l(B,2);Me(X,{size:1,color:"secondary",class:"header-content__version-count",children:(k,Y)=>{var ae=ne();$e(()=>Be(ae,`${e(H)+1} of ${e(de).length??""}`)),t(k,ae)},$$slots:{default:!0}});var Ae=l(X,2);{let k=D(()=>e(H)===e(de).length-1?"":"Switch to next script"),Y=D(()=>[pt.Hover]);ot(Ae,{get content(){return e(k)},get triggerOn(){return e(Y)},children:(ae,K)=>{{let G=D(()=>e(H)===e(de).length-1);xt(ae,{variant:"ghost-block",size:1,onclick:()=>ve(1),get disabled(){return e(G)},title:"Next version",children:(Ke,Le)=>{_e(Ke,{name:"chevron-right"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}t(A,h)},V=A=>{Me(A,{size:1,color:"secondary",class:"header-content__version-count",children:(h,B)=>{var X=ne("No versions");t(h,X)},$$slots:{default:!0}})};f(m,A=>{e(de).length>0?A(I):A(V,!1)});var J=l(m,2),ee=A=>{var h=Tr(),B=r(h);{let X=D(()=>e(ce).status===Ca.completed?"success":e(ce).status===Ca.error?"error":"loading");$s(B,{get commandResult(){return e(X)}})}t(A,h)};f(J,A=>{e(ce)?.status&&A(ee)});var b=l(R,2),p=r(b);Me(p,{size:1,weight:"medium",children:(A,h)=>{var B=ne("File Name");t(A,B)},$$slots:{default:!0}});var q=l(p,2);ia(q,{onblur:()=>{e(v)?e(v).endsWith(".sh")||n(v,e(v)+".sh"):n(v,"setup.sh")},placeholder:"Script name",size:1,get value(){return e(v)},set value(A){n(v,A,!0)}});var te=l(q,2);Me(te,{size:1,weight:"medium",children:(A,h)=>{var B=ne("Path");t(A,B)},$$slots:{default:!0}});var O=l(te,2);ut(O,()=>He.Root,(A,h)=>{h(A,{children:(B,X)=>{var Ae=Or(),k=S(Ae);ut(k,()=>He.Trigger,(ae,K)=>{K(ae,{children:(G,Ke)=>{{let Le=D(()=>e(z)==="home"?"~/.augment/env/":".augment/env");ia(G,{get value(){return e(Le)},placeholder:"Script name",size:1,children:(xe,Fe)=>{_e(xe,{name:"chevron-down"})},$$slots:{default:!0}})}},$$slots:{default:!0}})});var Y=l(k,2);ut(Y,()=>He.Content,(ae,K)=>{K(ae,{size:1,children:(G,Ke)=>{var Le=Hr(),xe=S(Le);ut(xe,()=>He.Item,(je,Ee)=>{Ee(je,{onSelect:()=>n(z,"home"),children:(qe,j)=>{{let M=D(()=>[pt.Hover]);ot(qe,{content:"Save the setup script in your machine's home directory",get triggerOn(){return e(M)},children:(be,Je)=>{var Z=Nr(),De=r(Z);Me(De,{size:1,weight:"medium",children:(me,fe)=>{var Re=ne("~/.augment/env/");t(me,Re)},$$slots:{default:!0}});var Ce=l(De,2);ut(Ce,()=>xa.Root,(me,fe)=>{fe(me,{variant:"soft",color:"info",size:1,children:(Re,le)=>{var ke=ne("Local");t(Re,ke)},$$slots:{default:!0}})}),t(be,Z)},$$slots:{default:!0}})}},$$slots:{default:!0}})});var Fe=l(xe,2);ut(Fe,()=>He.Item,(je,Ee)=>{Ee(je,{onSelect:()=>n(z,"git"),children:(qe,j)=>{{let M=D(()=>[pt.Hover]);ot(qe,{content:"Save the setup script in the Git repository, for your team to use when you push your changes",get triggerOn(){return e(M)},children:(be,Je)=>{var Z=Ur(),De=r(Z);Me(De,{size:1,weight:"medium",children:(me,fe)=>{var Re=ne(".augment/env");t(me,Re)},$$slots:{default:!0}});var Ce=l(De,2);ut(Ce,()=>xa.Root,(me,fe)=>{fe(me,{variant:"soft",color:"info",size:1,children:(Re,le)=>{var ke=ne("Repo");t(Re,ke)},$$slots:{default:!0}})}),t(be,Z)},$$slots:{default:!0}})}},$$slots:{default:!0}})}),t(G,Le)},$$slots:{default:!0}})}),t(B,Ae)},$$slots:{default:!0}})});var _=l(O,2),d=r(_);{let A=D(()=>e(W)||!e(v)||!e(z));gt(d,{variant:"soft",color:"neutral",size:2,get disabled(){return e(A)},onclick:()=>oe(e(z)),children:(h,B)=>{var X=ne();$e(()=>Be(X,"Save Script")),t(h,X)},$$slots:{default:!0}})}var $=l(_,2),u=A=>{var h=Gr(),B=r(h);Me(B,{size:1,color:"error",children:(X,Ae)=>{var k=ne();$e(()=>Be(k,e(w))),t(X,k)},$$slots:{default:!0}}),t(A,h)};f($,A=>{e(w)&&A(u)}),t(y,E)};f(U,y=>{e(de).length>0&&y(T)}),t(Se,c),lt(),C()}var Wr=o('<div class="c-card-button__subtitle svelte-18cj5ew"><!></div>'),Vr=o('<div class="c-card-button__icon-right svelte-18cj5ew"><!></div>'),Kr=o('<div class="c-card-button__icon-left svelte-18cj5ew"><!></div> <div class="c-card-button__content svelte-18cj5ew"><div class="c-card-button__title svelte-18cj5ew"><!></div> <!></div> <!>',1);function Fa(Se,a){const s=da(a);let g=se(a,"title",8,"Select an option"),C=se(a,"subtitle",8,"");var i=Kr(),v=S(i),z=r(v);tt(z,a,"iconLeft",{},null);var W=l(v,2),w=r(W),H=r(w);tt(H,a,"title",{},he=>{Me(he,{size:2,children:(Q,N)=>{var ve=ne();$e(()=>Be(ve,g())),t(Q,ve)},$$slots:{default:!0}})});var de=l(w,2),ie=he=>{var Q=Wr(),N=r(Q);tt(N,a,"subtitle",{},ve=>{Me(ve,{size:2,children:(oe,c)=>{var U=ne();$e(()=>Be(U,C())),t(oe,U)},$$slots:{default:!0}})}),t(he,Q)};f(de,he=>{C()&&he(ie)});var ce=l(W,2),ge=he=>{var Q=Vr(),N=r(Q);tt(N,a,"iconRight",{},null),t(he,Q)};f(ce,he=>{Pe(()=>s.iconRight)&&he(ge)}),t(Se,i)}var Jr=o('<div role="button"><!></div>'),Xr=o('<div class="c-card__dropdown-contents svelte-15clipb"><div class="c-card-button__dropdown-top svelte-15clipb"><!></div> <div class="c-card-button__dropdown-content svelte-15clipb"><!></div></div>'),Yr=o("<!> <!>",1),Qr=o('<button class="c-card-button__display svelte-15clipb" type="button"><!></button>'),Zr=o('<div class="c-card-button svelte-15clipb"><!></div>');function Ia(Se,a){it(a,!1);let s=se(a,"type",8,"button"),g=se(a,"title",8,"Select an option"),C=se(a,"subtitle",8,""),i=se(a,"onClick",8,()=>{}),v=se(a,"items",24,()=>[]),z=se(a,"selectedItem",28,()=>{}),W=se(a,"formatItemLabel",8,U=>U?.toString()||""),w=se(a,"noItemsLabel",8,"No items found"),H=se(a,"onDropdownOpenChange",8,()=>{}),de=se(a,"disabled",8,!1),ie=ue();function ce(){e(ie)?.requestClose()}function ge(U){z(U),he("select",U)}const he=It();var Q={requestClose:ce,selectItem:ge};Rt();var N=Zr(),ve=r(N),oe=U=>{Lt(He.Root(U,{get onOpenChange(){return H()},children:(T,y)=>{var E=Yr(),R=S(E);He.Trigger(R,{children:(L,x)=>{var P=Jr();let m;Fa(r(P),{get subtitle(){return C()},$$slots:{iconLeft:(I,V)=>{var J=pe(),ee=S(J);tt(ee,a,"iconLeft",{},null),t(I,J)},title:(I,V)=>{var J=pe(),ee=S(J);tt(ee,a,"title",{},b=>{var p=ne();$e(()=>Be(p,g())),t(b,p)}),t(I,J)},iconRight:(I,V)=>{var J=pe(),ee=S(J);tt(ee,a,"iconRight",{},b=>{_e(b,{name:"chevron-down"})}),t(I,J)}}}),$e(I=>{m=Yt(P,1,"c-card-button__display svelte-15clipb",null,m,I),Vt(P,"tabindex",de()?-1:0)},[()=>({disabled:de()})]),t(L,P)},$$slots:{default:!0}});var F=l(R,2);He.Content(F,{align:"start",side:"bottom",children:(L,x)=>{var P=Xr(),m=r(P),I=r(m);tt(I,a,"dropdown-top",{},null);var V=l(m,2),J=r(V);tt(J,a,"dropdown-content",{},ee=>{var b=pe(),p=S(b),q=O=>{var _=pe(),d=S(_);jt(d,1,v,$=>W()($),($,u)=>{{let A=ht(()=>z()===e(u));He.Item($,{onSelect:()=>ge(e(u)),get highlight(){return e(A)},children:(h,B)=>{var X=ne();$e(Ae=>Be(X,Ae),[()=>(Te(W()),e(u),Pe(()=>W()(e(u))))]),t(h,X)},$$slots:{default:!0}})}}),t(O,_)},te=O=>{He.Label(O,{children:(_,d)=>{var $=ne();$e(()=>Be($,w())),t(_,$)},$$slots:{default:!0}})};f(p,O=>{Te(v()),Pe(()=>v().length>0)?O(q):O(te,!1)}),t(ee,b)}),t(L,P)},$$slots:{default:!0}}),t(T,E)},$$slots:{default:!0},$$legacy:!0}),T=>n(ie,T),()=>e(ie))},c=U=>{var T=Qr();Fa(r(T),{get title(){return g()},get subtitle(){return C()},$$slots:{iconLeft:(y,E)=>{var R=pe(),F=S(R);tt(F,a,"iconLeft",{},null),t(y,R)},iconRight:(y,E)=>{var R=pe(),F=S(R);tt(F,a,"iconRight",{},null),t(y,R)}}}),$e(()=>T.disabled=de()),$t("click",T,()=>{i()(),he("click")}),$t("keydown",T,y=>{y.key!=="Enter"&&y.key!==" "||(i()(),he("click"))}),t(U,T)};return f(ve,U=>{s()==="dropdown"?U(oe):U(c,!1)}),t(Se,N),ba(a,"requestClose",ce),ba(a,"selectItem",ge),lt(Q)}var en=o('<div slot="iconRight"><!></div>'),tn=o('<a target="_blank"> </a>'),an=o('<!> <div class="github-auth-error-url-container svelte-g0bk5e"><!> <!></div>',1),sn=o('<div class="github-auth-error svelte-g0bk5e"><!> <!> <!></div>'),rn=o("<!> <!>",1),nn=o("<!> <!>",1),on=o('<div slot="dropdown-content"><!></div>'),ln=o('<div class="github-auth-card svelte-g0bk5e"><div class="github-auth-button"><!></div></div>');function cn(Se,a){it(a,!1);const s=It(),g=mt(Zt.key);let C=ue(!1),i=ue(!1),v=ue(!1),z=null,W=null,w=ue(void 0),H=ue(void 0);async function de(){if(n(w,void 0),n(H,void 0),e(i))return n(i,!1),void(z&&(clearTimeout(z),z=null));n(i,!0);try{const{success:N,message:ve,url:oe}=await g.authenticateGithub();if(!N)throw n(H,oe),new Error(ve);W=setInterval(async()=>{try{await g.isGithubAuthenticated()&&(n(C,!0),n(i,!1),s("authStateChange",{isAuthenticated:!0}),W&&clearInterval(W),z&&(clearTimeout(z),z=null))}catch(c){console.error("Failed to check GitHub authentication status:",c)}},5e3),z=setTimeout(()=>{W&&clearInterval(W),n(i,!1),z=null},6e4)}catch(N){console.error("Failed to authenticate with GitHub:",N),n(w,`Error: ${N instanceof Error?N.message:String(N)}`),n(i,!1)}}Ot(async()=>{await async function(){try{const N=await g.isGithubAuthenticated();N!==e(C)?(n(C,N),s("authStateChange",{isAuthenticated:e(C)})):n(C,N)}catch(N){console.error("Failed to check GitHub authentication status:",N),n(C,!1),s("authStateChange",{isAuthenticated:!1})}}()}),Qt(()=>{z&&(clearTimeout(z),z=null),W&&(clearInterval(W),W=null)}),Rt();var ie=ln(),ce=r(ie),ge=r(ce),he=N=>{var ve=rn(),oe=S(ve);{let T=ht(()=>e(i)?"Cancel":"Connect to GitHub");Ia(oe,{type:"button",get title(){return e(T)},onClick:de,$$slots:{iconLeft:(y,E)=>{_e(y,{name:"github",slot:"iconLeft"})},iconRight:(y,E)=>{var R=en(),F=r(R),L=P=>{Pt(P,{size:1,useCurrentColor:!0})},x=P=>{_e(P,{name:"chevron-right"})};f(F,P=>{e(i)?P(L):P(x,!1)}),t(y,R)}}})}var c=l(oe,2),U=T=>{var y=sn(),E=r(y);Me(E,{size:1,children:(x,P)=>{var m=ne("An error occurred while authenticating with GitHub.");t(x,m)},$$slots:{default:!0}});var R=l(E,2),F=x=>{var P=an(),m=S(P);Me(m,{size:1,children:(ee,b)=>{var p=ne("Visit or copy the following URL in your browser to authenticate manually:");t(ee,p)},$$slots:{default:!0}});var I=l(m,2),V=r(I);Me(V,{size:1,class:"github-auth-error-url",children:(ee,b)=>{var p=tn(),q=r(p);$e(()=>{Vt(p,"href",e(H)),Be(q,e(H))}),t(ee,p)},$$slots:{default:!0}});var J=l(V,2);Xs(J,{get text(){return e(H)},tooltipNested:!1}),t(x,P)};f(R,x=>{e(H)&&x(F)});var L=l(R,2);Me(L,{size:1,children:(x,P)=>{var m=ne();$e(()=>Be(m,e(w))),t(x,m)},$$slots:{default:!0}}),t(T,y)};f(c,T=>{e(w)&&T(U)}),t(N,ve)},Q=N=>{Ia(N,{type:"dropdown",title:"Connected to your GitHub account",$$slots:{iconLeft:(ve,oe)=>{_e(ve,{name:"github",slot:"iconLeft"})},"dropdown-content":(ve,oe)=>{var c=on(),U=r(c);He.Item(U,{color:"error",onSelect:()=>{(async function(){if(!e(v)){n(v,!0);try{const T=await g.revokeGithubAccess();T.success?(n(C,!1),s("authStateChange",{isAuthenticated:!1})):console.error("Failed to revoke GitHub access:",T.message)}catch(T){console.error("Error revoking GitHub access:",T)}finally{n(v,!1)}}})()},children:(T,y)=>{var E=pe(),R=S(E),F=x=>{var P=nn(),m=S(P);Pt(m,{slot:"iconLeft",useCurrentColor:!0,size:1});var I=l(m,2);Me(I,{size:1,weight:"medium",children:(V,J)=>{var ee=ne("Revoking...");t(V,ee)},$$slots:{default:!0}}),t(x,P)},L=x=>{Me(x,{size:1,weight:"medium",children:(P,m)=>{var I=ne("Revoke Access");t(P,I)},$$slots:{default:!0}})};f(R,x=>{e(v)?x(F):x(L,!1)}),t(T,E)},$$slots:{default:!0}}),t(ve,c)}}})};f(ge,N=>{e(C)?N(Q,!1):N(he)}),t(Se,ie),lt()}var dn=o('<div class="c-searchable-dropdown__input-container svelte-59urdx"><div class="c-searchable-dropdown__icon svelte-59urdx"><!></div> <input type="text" class="c-searchable-dropdown__trigger-input svelte-59urdx"/> <!></div>'),un=o('<div role="button"><div class="c-searchable-dropdown__icon-text svelte-59urdx"><div class="c-searchable-dropdown__icon svelte-59urdx"><!></div> <span class="c-searchable-dropdown__button-text svelte-59urdx"><!></span></div> <div class="c-searchable-dropdown__chevron svelte-59urdx"><!></div></div>'),vn=o('<!> <div class="c-searchable-dropdown__separator svelte-59urdx"><!></div>',1),hn=o('<div class="c-searchable-dropdown__loading svelte-59urdx"><!> <span> </span></div>'),pn=o('<div class="c-searchable-dropdown__item-title svelte-59urdx"><!></div>'),gn=o("<!> <!>",1),mn=o('<div class="c-searchable-dropdown__content svelte-59urdx"><!> <!> <!> <div style="margin-bottom: var(--ds-spacing-2);"></div></div>'),fn=o("<!> <!>",1),_n=o('<div class="c-searchable-dropdown svelte-59urdx"><!></div>');function ca(Se,a){const s=da(a);it(a,!1);let g=se(a,"title",8,""),C=se(a,"placeholder",8,"Search..."),i=se(a,"isLoading",8,!1),v=se(a,"disabled",8,!1),z=se(a,"searchValue",12,""),W=se(a,"items",24,()=>[]),w=se(a,"selectedItem",12,null),H=se(a,"actions",24,()=>[]),de=se(a,"actionLabelFn",8,y=>y?.toString()||""),ie=se(a,"itemTitle",24,()=>{}),ce=se(a,"itemLabelFn",8,y=>y?.toString()||""),ge=se(a,"itemKeyFn",8,y=>y?.toString()||""),he=se(a,"isItemSelected",24,()=>{}),Q=se(a,"noItemsLabel",8,"No items found"),N=se(a,"loadingLabel",8,"Loading..."),ve=ue(!1),oe=ue();const c=It();Rt();var U=_n(),T=r(U);Lt(He.Root(T,{onOpenChange:function(y){if(!v()){if(n(ve,y),y&&w()){const E=ce()(w());z(E),c("search",""),setTimeout(()=>{const R=document.querySelector(".c-searchable-dropdown__trigger-input");R&&R.select()},0)}else y&&(z(""),c("search",""));c("openChange",y)}},children:(y,E)=>{var R=fn(),F=S(R);He.Trigger(F,{children:(P,m)=>{var I=pe(),V=S(I),J=b=>{var p=dn(),q=r(p),te=r(q);tt(te,a,"searchIcon",{},$=>{var u=pe(),A=S(u);tt(A,a,"icon",{},null),t($,u)});var O=l(q,2),_=l(O,2),d=$=>{var u=pe(),A=S(u);tt(A,a,"inputButton",{},null),t($,u)};f(_,$=>{Pe(()=>s.inputButton)&&$(d)}),$e(()=>Vt(O,"placeholder",C())),Ys(O,z),$t("input",O,$=>{return u=$.currentTarget.value,z(u),void c("search",u);var u}),$t("click",O,Xt(function($){Jt.call(this,a,$)})),$t("mousedown",O,Xt(function($){Jt.call(this,a,$)})),t(b,p)},ee=b=>{var p=un();let q;var te=r(p),O=r(te),_=r(O),d=k=>{Pt(k,{size:1,useCurrentColor:!0})},$=k=>{var Y=pe(),ae=S(Y);tt(ae,a,"icon",{},null),t(k,Y)};f(_,k=>{i()?k(d):k($,!1)});var u=l(O,2),A=r(u),h=k=>{var Y=pe(),ae=S(Y);tt(ae,a,"title",{},null),t(k,Y)},B=k=>{var Y=ne();$e(()=>Be(Y,i()?N():g())),t(k,Y)};f(A,k=>{Pe(()=>s.title)?k(h):k(B,!1)});var X=l(te,2),Ae=r(X);_e(Ae,{name:"chevron-down"}),$e(k=>{q=Yt(p,1,"c-searchable-dropdown__button svelte-59urdx",null,q,k),Vt(p,"tabindex",v()?-1:0)},[()=>({"c-searchable-dropdown__button--disabled":v()})]),t(b,p)};f(V,b=>{e(ve)?b(J):b(ee,!1)}),t(P,I)},$$slots:{default:!0}});var L=l(F,2),x=P=>{He.Content(P,{side:"top",align:"start",children:(m,I)=>{var V=mn(),J=r(V),ee=_=>{var d=vn(),$=S(d);jt($,1,H,h=>h.name,(h,B)=>{He.Item(h,{onSelect:()=>function(X){c("action",X.type),e(oe)?.requestClose()}(e(B)),get disabled(){return e(B),Pe(()=>e(B).disabled)},children:(X,Ae)=>{var k=pe(),Y=S(k);tt(Y,a,"action",{get action(){return e(B)}},ae=>{var K=ne();$e(G=>Be(K,G),[()=>(Te(de()),e(B),Pe(()=>de()(e(B))))]),t(ae,K)}),t(X,k)},$$slots:{default:!0}})});var u=l($,2),A=r(u);He.Separator(A,{}),t(_,d)};f(J,_=>{Te(H()),Pe(()=>H().length>0)&&_(ee)});var b=l(J,2),p=_=>{He.Item(_,{disabled:!0,children:(d,$)=>{var u=hn(),A=r(u);Pt(A,{size:1,useCurrentColor:!0});var h=l(A,2),B=r(h);$e(()=>Be(B,N())),t(d,u)},$$slots:{default:!0}})},q=_=>{var d=pe(),$=S(d),u=h=>{var B=gn(),X=S(B),Ae=Y=>{var ae=pn(),K=r(ae);Me(K,{size:1,class:"c-searchable-dropdown__item-title",children:(G,Ke)=>{var Le=ne();$e(()=>Be(Le,ie())),t(G,Le)},$$slots:{default:!0}}),t(Y,ae)};f(X,Y=>{ie()&&Y(Ae)});var k=l(X,2);jt(k,3,W,(Y,ae)=>Y===null?`null-item-${ae}`:ge()(Y,ae),(Y,ae)=>{{let K=ht(()=>(Te(he()),e(ae),Te(w()),Te(ce()),Pe(()=>he()?he()(e(ae),w()):!!w()&&ce()(w())===ce()(e(ae)))));He.Item(Y,{onSelect:()=>function(G){w(G),c("select",G),e(oe)?.requestClose()}(e(ae)),get highlight(){return e(K)},children:(G,Ke)=>{var Le=pe(),xe=S(Le);tt(xe,a,"item",{get item(){return e(ae)}},Fe=>{var je=ne();$e(Ee=>Be(je,Ee),[()=>(Te(ce()),e(ae),Pe(()=>ce()(e(ae))))]),t(Fe,je)}),t(G,Le)},$$slots:{default:!0}})}}),t(h,B)},A=h=>{var B=pe(),X=S(B),Ae=k=>{He.Item(k,{disabled:!0,children:(Y,ae)=>{var K=ne();$e(()=>Be(K,Q())),t(Y,K)},$$slots:{default:!0}})};f(X,k=>{Q()&&k(Ae)},!0),t(h,B)};f($,h=>{Te(W()),Pe(()=>W().length>0)?h(u):h(A,!1)},!0),t(_,d)};f(b,_=>{i()?_(p):_(q,!1)});var te=l(b,2),O=_=>{var d=pe(),$=S(d);tt($,a,"footer",{},null),t(_,d)};f(te,_=>{Pe(()=>s.footer)&&_(O)}),t(m,V)},$$slots:{default:!0}})};f(L,P=>{v()||P(x)}),t(y,R)},$$slots:{default:!0},$$legacy:!0}),y=>n(oe,y),()=>e(oe)),t(Se,U),lt()}class ha{constructor(a,s=ha._defaultPagesPerLoad){this.gitRefModel=a,this._pagesPerLoad=s}_selectedRepo=yt(void 0);_selectedBranch=yt(void 0);_allRepos=yt([]);_allBranches=yt([]);_addedRepos=[];_error=void 0;_isDevDeploy=!1;static _defaultPagesPerLoad=20;_loadedRepoPages=0;_hasMoreRepoPages=!1;_loadedBranchPages=0;_hasMoreBranchPages=!1;_lastUsedRepoUrl;_lastUsedBranchName;_shouldCancelFetches=!1;cancelOngoingFetches(){this._shouldCancelFetches=!0}get selectedRepo(){return this._selectedRepo}set selectedRepo(a){this._selectedRepo.set(a),this._allBranches.set([])}get selectedBranch(){return this._selectedBranch}set selectedBranch(a){this._selectedBranch.set(a)}get allRepos(){return this._allRepos}get allBranches(){return this._allBranches}get error(){return this._error}get isDevDeploy(){return this._isDevDeploy}set lastUsedRepoUrl(a){this._lastUsedRepoUrl=a}get lastUsedRepoUrl(){return this._lastUsedRepoUrl}set lastUsedBranchName(a){this._lastUsedBranchName=a}get lastUsedBranchName(){return this._lastUsedBranchName}async updateReposList(){const{repos:a,error:s,isDevDeploy:g}=await this.gitRefModel.listUserRepos();if(g)return this._isDevDeploy=!0,void this._allRepos.set(await this.fetchLocalRepos());if(s)this._error=s;else{this._isDevDeploy=g||!1;try{const C=await this.getCurrentWorkspaceRepo();if(C&&!a.some(i=>i.name===C.name&&i.owner===C.owner)){const{repo:i,error:v}=await this.gitRefModel.getGithubRepo(C);v?console.error("Failed to fetch GitHub repo:",v):i&&a.unshift(i)}}catch(C){console.error("Failed to fetch GitHub repo:",C)}this._allRepos.set([...this._addedRepos,...a])}}async updateRepos(a=!1,s,g){return this._loadedRepoPages=0,this._hasMoreBranchPages=!1,this._allRepos.set([]),this._shouldCancelFetches=!1,await this.updateReposAtPage(1,a,s,g),this._hasMoreRepoPages}async loadMoreRepos(a){return!!this._hasMoreRepoPages&&(this._shouldCancelFetches=!1,await this.updateReposAtPage(this._loadedRepoPages+1,!1,void 0,a),this._hasMoreRepoPages)}async preselectRepo(){if(_t(this._selectedRepo))return!1;const a=C=>{const i=_t(this._allRepos).find(v=>v.html_url===C);return!!i&&(this._selectedRepo.set(i),!0)},s=await this.getCurrentWorkspaceRepo(),g=_t(this._allRepos);if(s){const C=g.find(i=>i.name===s.name&&i.owner===s.owner);if(C)return this._selectedRepo.set(C),!0}return this._lastUsedRepoUrl?a(this._lastUsedRepoUrl):(this._selectedRepo.set(g[0]),!0)}async preselectLocalRepo(){if(_t(this._selectedRepo))return!1;const a=await this.getCurrentWorkspaceRepo();if(!a)return!1;const{repo:s,error:g}=await this.gitRefModel.getGithubRepo(a);return g?(console.error("Failed to preselect local repo:",g),!1):(this._selectedRepo.set(s),!0)}addRepo(a){this._addedRepos.push(a),this._allRepos.update(s=>s.some(g=>g.name===a.name&&g.owner===a.owner)?s:[a,...s])}async updateBranches(a=!1,s,g){return!!_t(this._selectedRepo)&&(this._isDevDeploy?(this._allBranches.set(await this.fetchLocalBranches()),!1):(this._loadedBranchPages=0,this._hasMoreBranchPages=!1,this._allBranches.set([]),this._shouldCancelFetches=!1,await this.updateBranchesAtPage(1,a,s,g),this._hasMoreBranchPages))}async loadMoreBranches(a){return!!this._hasMoreBranchPages&&(this._shouldCancelFetches=!1,await this.updateBranchesAtPage(this._loadedBranchPages+1,!1,void 0,a),this._hasMoreBranchPages)}preselectBranch(){const a=_t(this._selectedRepo);if(!a||_t(this._selectedBranch))return!1;const s=_t(this._allBranches);if(this._lastUsedBranchName){const g=s.find(C=>C.name===this._lastUsedBranchName);if(g)return this._selectedBranch.set(g),!0}if(a.default_branch){const g=s.find(C=>C.name===a.default_branch);return g?(this._selectedBranch.set(g),!0):(this._selectedBranch.set({name:a.default_branch,commit:{sha:"",url:""},protected:!1}),!0)}return this._selectedBranch.set(s[0]),!0}async fetchLocalRepos(){console.warn("Fetching repos from local git environment.");const{remoteUrl:a,error:s}=await this.gitRefModel.getRemoteUrl(),g=la(a);if(!g||s)return this._error=s??"Failed to parse remote URL in your local git repo.",[];const{owner:C,name:i}=g;return[{name:i,owner:C,html_url:a}]}async fetchLocalBranches(){console.warn("Fetching branches from local git environment.");const a=function(C){return C.filter(i=>i.isRemote)}((await this.gitRefModel.listBranches()).branches),s=a.find(C=>C.isDefault),g=C=>({name:Ga(C.name),commit:{sha:"",url:""},protected:!1});return s&&this._selectedBranch.set(g(s)),a.map(g)}async getCurrentWorkspaceRepo(){const{remoteUrl:a,error:s}=await this.gitRefModel.getRemoteUrl();if(s)return;const g=la(a);if(!g)return;const{owner:C,name:i}=g;return{name:i,owner:C,html_url:a}}async updateReposAtPage(a,s=!1,g,C){if(!(a<=this._loadedRepoPages))do{if(C?.aborted||this._shouldCancelFetches)break;await new Promise(v=>setTimeout(v,0));const i=await this.gitRefModel.listUserRepos(a);if(i.error){this._error=i.error;break}if(i.isDevDeploy){this._isDevDeploy=!0,this._allRepos.set(await this.fetchLocalRepos());break}this._isDevDeploy&&(this._isDevDeploy=!1),this._allRepos.update(v=>[...v,...i.repos]),a=i.nextPage,this._loadedRepoPages++,this._hasMoreRepoPages=i.hasNextPage,s&&await this.preselectRepo()&&g?.()}while(this._loadedRepoPages%this._pagesPerLoad!=0&&this._hasMoreRepoPages)}async updateBranchesAtPage(a,s=!1,g,C){const i=_t(this._selectedRepo);if(i&&!(a<=this._loadedBranchPages))do{if(C?.aborted||this._shouldCancelFetches)break;if(i!==_t(this._selectedRepo)){this._allBranches.set([]);break}await new Promise(z=>setTimeout(z,0));const v=await this.gitRefModel.listRepoBranches(i,a);if(v.error){this._error=v.error;break}this._allBranches.update(z=>[...z,...v.branches]),a=v.nextPage,this._loadedBranchPages++,this._hasMoreBranchPages=v.hasNextPage,s&&this.preselectBranch()&&g?.()}while(this._loadedBranchPages%this._pagesPerLoad!=0&&this._hasMoreBranchPages)}}var $n=o("<!> <!>",1),bn=o('<button type="button" class="c-commit-ref-selector__item c-commit-ref-selector__item--loading svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></button>'),wn=o('<div class="c-commit-ref-selector__item c-commit-ref-selector__item--loading c-commit-ref-selector__item--disabled svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></div>'),yn=o("<!> <!>",1),Rn=o('<div slot="inputButton" class="c-commit-ref-selector__refresh-button svelte-akmdmd"><!></div>'),An=o('<button type="button" class="c-commit-ref-selector__item c-commit-ref-selector__item--loading svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></button>'),Sn=o('<div class="c-commit-ref-selector__item c-commit-ref-selector__item--loading c-commit-ref-selector__item--disabled svelte-akmdmd"><div class="c-commit-ref-selector__item-icon svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__item-content svelte-akmdmd"><!></div></div>'),Cn=o('<div class="c-commit-ref-selector__selectors-container svelte-akmdmd"><div class="c-commit-ref-selector__selector svelte-akmdmd"><!></div> <div class="c-commit-ref-selector__selector svelte-akmdmd"><!></div></div>'),kn=o('<span slot="iconLeft" class="svelte-akmdmd"><!></span>'),Ln=o('<div class="c-commit-ref-selector__error-content svelte-akmdmd"><div class="c-commit-ref-selector__error-message svelte-akmdmd"> </div> <!></div>'),xn=o('<div class="c-commit-ref-selector__error svelte-akmdmd"><!></div>'),Dn=o('<div class="c-commit-ref-selector svelte-akmdmd"><div class="c-commit-ref-selector__content svelte-akmdmd"><!></div></div>');function Bn(Se,a){it(a,!1);const s=()=>Ge(y,"$selectedRepo",v),g=()=>Ge(E,"$selectedBranch",v),C=()=>Ge(U,"$allRepos",v),i=()=>Ge(T,"$allBranches",v),[v,z]=wt(),W=ue(),w=ue(),H=ue(),de=ue(),ie=It();let ce=se(a,"errorMessage",12,""),ge=se(a,"isLoading",12,!1),he=se(a,"lastUsedBranchName",8,null),Q=se(a,"lastUsedRepoUrl",8,null),N=se(a,"onSelectedRepo",24,()=>{}),ve=se(a,"onSelectedBranch",24,()=>{}),oe=se(a,"gitRefModel",8);const c=ue(new ha(oe())),U=e(c).allRepos,T=e(c).allBranches,y=e(c).selectedRepo,E=e(c).selectedBranch;let R=ue("warning"),F=ue(!1),L=ue(!1),x=ue(!1),P=ue(!1),m=ue(!1);const I=new Set;let V=ue("Choose repository..."),J=!1;const ee=new Map;let b=ue(!1);const p=yt(""),q=yt(""),te=Wt(function(j){p.set(j),J=!0},300,{leading:!1,trailing:!0}),O=Wt(function(j){q.set(j),n(b,!0)},300,{leading:!1,trailing:!0}),_={failedToFetchBranches:"Failed to fetch branches. Please try again.",failedToFetchFromRemote:"Failed to fetch from remote. Please try again."};let d;Ot(async()=>{d=new AbortController,await k()}),Qt(()=>{d&&(d.abort(),e(c).cancelOngoingFetches())});const $=ma([U,p],([j,M],be)=>{n(W,!1),n(m,!1);try{if(J){const Je=la(M);Je&&oe().getGithubRepo(Je).then(({repo:Z,error:De})=>{if(De)throw new Error(De);const Ce=`${Z.owner}/${Z.name}`;ee.has(Ce)||(ee.set(Ce,Z),e(c).addRepo(Z)),n(m,!0),be([Z])}).catch(Z=>{console.error("Failed to get GitHub repo from URL",Z),be([])}),be(function(Z,De){if(De==="")return Z;const Ce=De.toLowerCase().split("/",2).filter(me=>me.length>0);return Z.filter(me=>{const fe=me.owner.toLowerCase(),Re=me.name.toLowerCase();return Ce.length===1?fe.includes(Ce[0])||Re.includes(Ce[0]):Ce.length!==2||Ce[0]===fe&&Re.includes(Ce[1])})}(j,M))}else be(j)}catch(Je){console.error("Error fetching repos:",Je),Y(_.failedToFetchFromRemote),be([])}}),u=ma([T,y,q],([j,M,be])=>{if(e(b)&&be.trim()!=="")return Je=be,j.filter(Z=>Z.name.toLowerCase().includes(Je.toLowerCase()));if(M?.default_branch)return[j.find(De=>De.name===M?.default_branch)||{name:M.default_branch,commit:{sha:"",url:""},protected:!1},...j.filter(De=>De.name!==M?.default_branch)];return j;var Je});async function A(){n(L,!0),n(P,await e(c).updateRepos(!0,K,d?.signal)),function(){I.clear();const j=new Set;C().forEach(M=>{j.has(M.name)?I.add(M.name):j.add(M.name)})}(),await e(c).preselectRepo(),n(L,!1)}function h(){y&&async function(){s()&&(n(F,!0),n(x,await e(c).updateBranches(!0,K,d?.signal)),n(F,!1))}().then(()=>{ge(!1),e(W)||K()}).catch(j=>{console.error("Error fetching all branches:",j),Y(`Failed to fetch branches: ${j instanceof Error?j.message:String(j)}`)})}let B=ue(!0);const X=async()=>{try{n(B,await oe().isGithubAuthenticated()),e(B)||Y("Please authenticate with GitHub to use this feature.","info")}catch(j){console.error("Failed to check GitHub authentication status:",j),Y("Please authenticate with GitHub to use this feature."),n(B,!1)}};async function Ae(){ge(!0),n(W,!1),ce(""),n(R,"warning");try{if(await X(),!e(B))return void ge(!1);n(L,!0),n(F,!0);let j=!1;e(c).preselectLocalRepo().then(M=>(j=M,K(),M)).then(M=>{M&&h()}).catch(M=>{console.error("Failed to preselect local repo while fetching all repos: ",M)}),await A(),e(W)||j||(n(L,!1),h()),e(W)||K()}catch(j){console.error("Error fetching git data:",j),Y(_.failedToFetchBranches)}finally{ge(!1)}}async function k(){ge(!0);try{await Ae()}catch(j){console.error("Error fetching and syncing branches:",j),Y("Failed to fetch repos and branches. Please try again.")}finally{ge(!1)}}function Y(j,M="warning"){console.error("Error:",j),n(W,!0),ce(j),n(R,M)}function ae(j,M){j||(M==="repo"?J=!1:(M==="branch"||(J=!1),n(b,!1)))}function K(){if(!s()?.html_url||!g())return;const j={github_commit_ref:{repository_url:s().html_url,git_ref:g().name}};ie("commitRefChange",{commitRef:j,selectedBranch:g()})}const G=j=>{q.set(j)},Ke=j=>{p.set(j)};function Le(){h()}Ye(()=>Te(Q()),()=>{Nt(c,e(c).lastUsedRepoUrl=Q()??void 0)}),Ye(()=>Te(he()),()=>{Nt(c,e(c).lastUsedBranchName=he()??void 0)}),Ye(()=>Te(ce()),()=>{n(W,ce()!=="")}),Ye(()=>(s(),e(F),g()),()=>{n(w,s()&&e(F)&&!g())}),Ye(()=>(e(L),s()),()=>{n(H,e(L)&&!s())}),Ye(()=>s(),()=>{if(s()){const{owner:j,name:M}=s();n(V,I.has(M)?`${j}/${M}`:M)}else n(V,"Choose repository...")}),Ye(()=>(e(b),g()),()=>{e(b)?G(""):G(g()?.name??"")}),Ye(()=>(s(),e(b),i()),()=>{n(de,!s()||!e(b)&&!i().length)}),Ht(),Rt();var xe=Dn(),Fe=r(xe),je=r(Fe),Ee=j=>{var M=Cn(),be=r(M),Je=r(be);{let Ce=ht(()=>(C(),Pe(()=>!C().length)));ca(Je,{get title(){return e(V)},placeholder:"Search repositories or paste a GitHub URL...",itemKeyFn:me=>`${me.owner}-${me.name}`,get isLoading(){return e(H)},get disabled(){return e(Ce)},get items(){return Ge($,"$displayedRepos",v)},get selectedItem(){return s()},itemLabelFn:me=>`${me.owner}/${me.name}`,noItemsLabel:"No repositories found",loadingLabel:"Loading repositories...",get searchValue(){return _a(),Ge(p,"$repoSearchValue",v)},set searchValue(me){fa(p,me)},$$events:{openChange:me=>{var fe;(fe=me.detail)&&!C().length||ae(fe,"repo")},search:me=>te(me.detail),select:me=>async function(fe){n(F,!0),Nt(c,e(c).selectedRepo=fe),Nt(c,e(c).selectedBranch=void 0),J=!1,Ke(""),h(),N()?.()}(me.detail)},children:(me,fe)=>{var Re=$n(),le=S(Re);_e(le,{name:"github"});var ke=l(le,2);_e(ke,{name:"search"}),t(me,Re)},$$slots:{default:!0,footer:(me,fe)=>{var Re=pe(),le=S(Re),ke=at=>{{let Xe=ht(()=>(C(),Pe(()=>`${C().length} repos loaded`))),re=ht(()=>(Te(pt),Pe(()=>[pt.Hover])));ot(at,{get content(){return e(Xe)},get triggerOn(){return e(re)},nested:!1,children:(we,We)=>{var Ne=bn(),Ue=r(Ne),Ve=r(Ue);_e(Ve,{name:"chevrons-down"});var Ie=l(Ue,2),Qe=r(Ie);Me(Qe,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(Ze,st)=>{var ct=ne("Load more repos");t(Ze,ct)},$$slots:{default:!0}}),$t("click",Ne,async()=>{n(L,!0),n(P,await e(c).loadMoreRepos()),n(L,!1)}),t(we,Ne)},$$slots:{default:!0}})}},rt=at=>{var Xe=pe(),re=S(Xe),we=We=>{var Ne=wn(),Ue=r(Ne),Ve=r(Ue);Pt(Ve,{size:1});var Ie=l(Ue,2),Qe=r(Ie);Me(Qe,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(Ze,st)=>{var ct=ne("Loading repos...");t(Ze,ct)},$$slots:{default:!0}}),t(We,Ne)};f(re,We=>{e(L)&&We(we)},!0),t(at,Xe)};f(le,at=>{!e(P)||e(L)||e(m)?at(rt,!1):at(ke)}),t(me,Re)}},$$legacy:!0})}var Z=l(be,2),De=r(Z);{let Ce=ht(()=>(g(),Pe(()=>g()?.name||"Choose branch..."))),me=ht(()=>e(F)?"":"No branches found");ca(De,{get title(){return e(Ce)},itemKeyFn:(fe,Re)=>`${fe.name}-${fe.commit.sha}=${Re}`,placeholder:"Search branches...",get isLoading(){return e(w)},get disabled(){return e(de)},get items(){return Ge(u,"$displayedBranches",v)},get selectedItem(){return g()},itemLabelFn:fe=>fe.name.replace("origin/",""),get noItemsLabel(){return e(me)},loadingLabel:"Loading branches...",get searchValue(){return _a(),Ge(q,"$branchSearchValue",v)},set searchValue(fe){fa(q,fe)},$$events:{openChange:fe=>{var Re;(Re=fe.detail)&&e(de)||ae(Re,"branch")},search:fe=>O(fe.detail),select:fe=>async function(Re){Nt(c,e(c).selectedBranch=Re),n(b,!1),G(g()?.name??""),K(),ve()?.()}(fe.detail)},children:(fe,Re)=>{var le=yn(),ke=S(le);_e(ke,{name:"git-branch"});var rt=l(ke,2);_e(rt,{name:"search"}),t(fe,le)},$$slots:{default:!0,inputButton:(fe,Re)=>{var le=Rn(),ke=r(le);{let rt=ht(()=>(Te(pt),Pe(()=>[pt.Hover])));ot(ke,{content:"Refresh branches",get triggerOn(){return e(rt)},nested:!1,children:(at,Xe)=>{xt(at,{variant:"ghost",color:"neutral",size:1,$$events:{click:Le},children:(re,we)=>{_e(re,{name:"rotate-cw"})},$$slots:{default:!0}})},$$slots:{default:!0}})}t(fe,le)},footer:(fe,Re)=>{var le=pe(),ke=S(le),rt=Xe=>{{let re=ht(()=>(i(),Pe(()=>`${i().length} branches loaded`))),we=ht(()=>(Te(pt),Pe(()=>[pt.Hover])));ot(Xe,{get content(){return e(re)},get triggerOn(){return e(we)},nested:!1,children:(We,Ne)=>{var Ue=An(),Ve=r(Ue),Ie=r(Ve);_e(Ie,{name:"chevrons-down"});var Qe=l(Ve,2),Ze=r(Qe);Me(Ze,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(st,ct)=>{var dt=ne("Load more branches");t(st,dt)},$$slots:{default:!0}}),$t("click",Ue,async()=>{n(F,!0),n(x,await e(c).loadMoreBranches()),n(F,!1)}),t(We,Ue)},$$slots:{default:!0}})}},at=Xe=>{var re=pe(),we=S(re),We=Ne=>{var Ue=Sn(),Ve=r(Ue),Ie=r(Ve);Pt(Ie,{size:1});var Qe=l(Ve,2),Ze=r(Qe);Me(Ze,{size:2,color:"neutral",class:"c-commit-ref-selector__item-name",children:(st,ct)=>{var dt=ne("Loading branches...");t(st,dt)},$$slots:{default:!0}}),t(Ne,Ue)};f(we,Ne=>{e(F)&&Ne(We)},!0),t(Xe,re)};f(ke,Xe=>{e(x)&&!e(F)?Xe(rt):Xe(at,!1)}),t(fe,le)}},$$legacy:!0})}t(j,M)},qe=j=>{var M=pe(),be=S(M),Je=Z=>{var De=xn(),Ce=r(De);ta(Ce,{get color(){return e(R)},variant:"soft",size:2,children:(me,fe)=>{var Re=Ln(),le=r(Re),ke=r(le),rt=l(le,2),at=re=>{cn(re,{$$events:{authStateChange:async we=>{const{isAuthenticated:We}=we.detail;We!==e(B)&&(n(B,We),We&&await k())}}})},Xe=re=>{gt(re,{variant:"ghost",color:"warning",size:1,get loading(){return ge()},class:"c-commit-ref-selector__fetch-button",$$events:{click:k},children:(we,We)=>{var Ne=ne("Reload available repos and branches");t(we,Ne)},$$slots:{default:!0,iconLeft:(we,We)=>{var Ne=kn(),Ue=r(Ne);_e(Ue,{name:"refresh-ccw"}),t(we,Ne)}}})};f(rt,re=>{e(B)?re(Xe,!1):re(at)}),$e(()=>Be(ke,ce())),t(me,Re)},$$slots:{default:!0}}),t(Z,De)};f(be,Z=>{e(W)&&Z(Je)},!0),t(j,M)};f(je,j=>{e(W)?j(qe,!1):j(Ee)}),t(Se,xe),lt(),z()}var En=o('<div class="c-setup-script-selector__icon svelte-1fvykqe"><!></div>'),Pn=o('<span class="c-setup-script-selector__extension svelte-1fvykqe"> </span>'),Fn=o('<div class="c-setup-script-selector__rename-input svelte-1fvykqe" role="presentation"><div class="c-setup-script-selector__rename-input-container svelte-1fvykqe" role="presentation"><!> <!></div></div>'),In=o('<span class="c-setup-script-selector__script-path svelte-1fvykqe"> </span>'),zn=o('<span class="c-setup-script-selector__script-name svelte-1fvykqe"> </span> <!>',1),Mn=o('<div role="presentation"><!> <div class="c-setup-script-selector__script-info svelte-1fvykqe"><!></div> <div class="c-setup-script-selector__script-actions svelte-1fvykqe"><!></div></div>'),Tn=o("<!> <!>",1),Nn=o('<span slot="text"> </span>'),Un=o('<span slot="grayText"> </span>'),Hn=o('<span slot="text"> </span>'),On=o('<div slot="title"><!></div>'),Gn=o('<div class="c-action-selector svelte-g45zi9"><!> <!></div>'),qn=o("<!> <!> <!>",1),jn=o('<div class="c-setup-script-selector__script-line-container svelte-g45zi9"><div class="c-setup-script-selector__script-line svelte-g45zi9"><!></div></div>'),Wn=o('<span slot="iconLeft"><!></span>'),Vn=o('<div class="c-setup-script-selector__error-content svelte-g45zi9"><div class="c-setup-script-selector__error-message svelte-g45zi9"> </div> <!></div>'),Kn=o('<div class="c-setup-script-selector__error svelte-g45zi9"><!></div>'),Jn=o('<div class="c-setup-script-selector svelte-g45zi9"><div class="c-setup-script-selector__content svelte-g45zi9"><!> <!></div></div>');function Xn(Se,a){it(a,!1);const s=()=>Ge(Q,"$remoteAgentsModel",g),[g,C]=wt(),i=ue(),v=ue(),z=ue(),W=ue(),w=ue(),H=ue(),de=ue();let ie=se(a,"errorMessage",12,""),ce=se(a,"isLoading",8,!1),ge=se(a,"lastUsedScriptPath",8,null),he=se(a,"disableNewAgentCreation",8,!1);const Q=mt(At.key),N=It(),ve=ua(),oe=_=>{ve(Ha({repoRoot:"",pathName:_.path,allowOutOfWorkspace:!0,openLocalUri:_.location==="home"}))};let c=ue([]),U=ue(""),T=ue(null),y=ue(e(c)),E=!0,R=ue(null);const F=[{type:"basic",name:"Use basic environment",icon:"square-terminal"},{type:"auto",name:"Auto-generate setup script",icon:"wand-sparkles",disabled:he()},{type:"manual",name:"Write a script by hand",icon:"pencil"}],L={noScriptsFound:"No setup scripts found. You can create one in ~/.augment/env/, <git root>/.augment/env/, or <workspace root>/.augment/env/.",failedToFetchScripts:"Failed to fetch setup scripts. Please try again."};async function x(){ie("");try{const _=e(i)?.path;if(n(c,await Q.listSetupScripts()),E)if(ge()&&e(c).length>0){const d=e(c).find($=>$.path===ge());d&&(n(i,d),n(R,null),J())}else ge()===null&&(n(i,null),J());else if(_){const d=e(c).find($=>$.path===_);d&&(n(i,d),n(R,null))}E=!1,e(c).length===0?ie(L.noScriptsFound):ie("")}catch(_){console.error("Error fetching setup scripts:",_),ie(L.failedToFetchScripts)}}function P(){n(T,null)}function m(_){ie(_)}function I(_){if(n(R,_),n(i,null),_==="basic")V(null);else{if(_==="auto")return void Q.setGenerateSetupScriptSelected(!0);_==="manual"&&(async()=>{try{await Q.reportRemoteAgentSetupWindowEvent(kt.manuallyCreateSetupScript)}catch(d){console.error("Failed to report manually create setup script event:",d)}try{const d="setup.sh",$=`#!/bin/bash

# Setup Script for Remote Agent Environment
#
# This script installs dependencies and configures the environment for your project.
# It runs with sudo privileges when needed.
#
# Examples:
# sudo apt-get update && sudo apt-get install -y package-name
# pip install package-name
# npm install -g package-name
# export ENV_VAR=value

# Add your commands below:

`,u=await Q.saveSetupScript(d,$,"home");if(u.success&&u.path){await x();const A=e(c).find(h=>h.path===u.path);A&&(V(A),oe(A))}else console.error("Failed to create manual setup script:",u.error),ie(`Failed to create manual setup script: ${u.error||"Unknown error"}`)}catch(d){console.error("Error creating manual setup script:",d),ie(`Error creating manual setup script: ${d instanceof Error?d.message:String(d)}`)}})()}Q.setGenerateSetupScriptSelected(!1)}async function V(_){if(n(i,_),J(),Q.saveLastRemoteAgentSetup(null,null,e(i)?.path||null),_)try{await Q.reportRemoteAgentSetupWindowEvent(kt.selectSetupScript)}catch(d){console.error("Failed to report setup script selection event:",d)}}function J(){N("setupScriptChange",{script:e(i)})}Ot(async()=>{await x(),ge()===null?V(null):s().newAgentDraft?.setupScript&&!e(i)&&V(s().newAgentDraft.setupScript)}),Qt(()=>{Q.setGenerateSetupScriptSelected(!1)}),Ye(()=>s(),()=>{n(i,s().newAgentDraft?.setupScript??null)}),Ye(()=>Te(ie()),()=>{n(v,ie()!=="")}),Ye(()=>(e(U),e(c)),()=>{if(e(U).trim()!==""){const _=e(c).filter(d=>d.name.toLowerCase().includes(e(U).toLowerCase())||d.path.toLowerCase().includes(e(U).toLowerCase()));n(y,_)}else n(y,e(c))}),Ye(()=>(Te(ce()),e(i),e(R)),()=>{n(z,()=>ce()?"...":e(i)?e(i).isGenerateOption?e(i).name:e(i).location==="home"?"~/.augment/env/"+e(i).name:e(i).path:e(R)?F.find(d=>d.type===e(R))?.name||e(R):"Use basic environment")}),Ye(()=>e(z),()=>{n(W,e(z)())}),Ye(()=>e(i),()=>{n(w,!!e(i)?.path)}),Ye(()=>(e(w),e(W)),()=>{n(H,e(w)?e(W).split("/").pop():e(W))}),Ye(()=>(e(w),e(W)),()=>{n(de,e(w)?e(W).slice(0,e(W).lastIndexOf("/")):"")}),Ht(),Rt();var ee=Jn(),b=r(ee),p=r(b),q=_=>{var d=jn(),$=r(d);ca(r($),{placeholder:"Search scripts...",get isLoading(){return ce()},disabled:!1,get actions(){return F},actionLabelFn:u=>u?.name||"",get items(){return e(y)},get selectedItem(){return e(i)},itemTitle:"Available scripts",itemLabelFn:u=>u?.name||"",itemKeyFn:u=>`${u?.path}-${u?.location}-${u?.name}`,isItemSelected:(u,A)=>u===null&&A===null||!(!u||!A)&&u.path===A.path,noItemsLabel:"No scripts found",loadingLabel:"Loading scripts...",get searchValue(){return e(U)},set searchValue(u){n(U,u)},$$events:{openChange:u=>{u.detail&&(x(),n(U,""))},search:u=>{return A=u.detail,void n(U,A);var A},select:u=>{V(u.detail)},action:u=>I(u.detail)},children:(u,A)=>{var h=Tn(),B=S(h);_e(B,{name:"terminal"});var X=l(B,2);_e(X,{name:"search"}),t(u,h)},$$slots:{default:!0,title:(u,A)=>{var h=On(),B=r(h),X=k=>{Ea(k,{$$slots:{text:(Y,ae)=>{var K=Nn(),G=r(K);$e(()=>Be(G,e(H))),t(Y,K)},grayText:(Y,ae)=>{var K=Un(),G=r(K);$e(()=>Be(G,e(de))),t(Y,K)}}})},Ae=k=>{Ea(k,{$$slots:{text:(Y,ae)=>{var K=Hn(),G=r(K);$e(()=>Be(G,e(W))),t(Y,K)}}})};f(B,k=>{e(w)?k(X):k(Ae,!1)}),t(u,h)},action:(u,A)=>{const h=ht(()=>A.action);var B=pe(),X=S(B),Ae=k=>{var Y=Gn(),ae=r(Y);_e(ae,{get name(){return Te(e(h)),Pe(()=>e(h).icon)}});var K=l(ae,2);Me(K,{size:1,children:(G,Ke)=>{var Le=ne();$e(()=>Be(Le,(Te(e(h)),Pe(()=>e(h).name)))),t(G,Le)},$$slots:{default:!0}}),t(k,Y)};f(X,k=>{e(h)&&k(Ae)}),t(u,B)},item:(u,A)=>{const h=ht(()=>A.item);var B=pe(),X=S(B),Ae=k=>{{let Y=ht(()=>(e(T),Te(e(h)),Pe(()=>e(T)?.path===e(h).path)));(function(ae,K){const G=da(K);it(K,!1);let Ke=se(K,"name",8),Le=se(K,"path",8),xe=se(K,"isPath",8,!1),Fe=se(K,"isRenaming",8,!1),je=se(K,"showPath",8,!0);const Ee=It(),{baseName:qe,extension:j}=function(re){const we=re.lastIndexOf(".");return we===-1?{baseName:re,extension:""}:{baseName:re.substring(0,we),extension:re.substring(we)}}(Ke());let M=ue(qe),be=ue(void 0);function Je(re){if(re.key!=="ArrowLeft"&&re.key!=="ArrowRight"&&re.key!=="ArrowUp"&&re.key!=="ArrowDown")if(re.key==="Enter")if(re.preventDefault(),e(M).trim()&&e(M)!==qe){const we=e(M).trim()+j;Ee("rename",{oldName:Ke(),newName:we})}else Ee("cancelRename");else re.key==="Escape"&&(re.preventDefault(),re.stopPropagation(),Ee("cancelRename"));else re.stopPropagation()}function Z(){Ee("cancelRename")}Ye(()=>(Te(Fe()),e(be)),()=>{Fe()&&e(be)&&setTimeout(()=>{e(be)?.focus(),e(be)?.select()},0)}),Ht(),Rt();var De=Mn();let Ce;var me=r(De),fe=re=>{var we=En(),We=r(we);tt(We,K,"icon",{},null),t(re,we)};f(me,re=>{Pe(()=>G.icon)&&re(fe)});var Re=l(me,2),le=r(Re),ke=re=>{var we=Fn(),We=r(we),Ne=r(We);ia(Ne,{size:1,variant:"surface",get value(){return e(M)},set value(Ie){n(M,Ie)},get textInput(){return e(be)},set textInput(Ie){n(be,Ie)},$$events:{keydown:Je,blur:Z},$$legacy:!0});var Ue=l(Ne,2),Ve=Ie=>{var Qe=Pn(),Ze=r(Qe);$e(()=>Be(Ze,j)),t(Ie,Qe)};f(Ue,Ie=>{j&&Ie(Ve)}),$t("click",we,Xt(function(Ie){Jt.call(this,K,Ie)})),$t("mousedown",we,Xt(function(Ie){Jt.call(this,K,Ie)})),t(re,we)},rt=re=>{var we=zn(),We=S(we),Ne=r(We),Ue=l(We,2),Ve=Ie=>{var Qe=In(),Ze=r(Qe);$e(()=>Be(Ze,Le())),t(Ie,Qe)};f(Ue,Ie=>{je()&&Ie(Ve)}),$e(()=>Be(Ne,Ke())),t(re,we)};f(le,re=>{Fe()?re(ke):re(rt,!1)});var at=l(Re,2),Xe=r(at);tt(Xe,K,"default",{},null),$e(re=>Ce=Yt(De,1,"c-setup-script-selector__script-item-content svelte-1fvykqe",null,Ce,re),[()=>({"c-setup-script-selector__script-item-content--renaming":Fe(),"c-setup-script-selector__script-item-content--is-path":xe()})]),t(ae,De),lt()})(k,{get name(){return Te(e(h)),Pe(()=>e(h).name)},get path(){return Te(e(h)),Pe(()=>e(h).path)},isPath:!0,showPath:!1,get isRenaming(){return e(Y)},$$events:{rename:ae=>async function(K,G){const{oldName:Ke,newName:Le}=G.detail;try{const xe=await Q.renameSetupScript(Ke,Le,K.location);if(xe.success){await x();const Fe=e(c).find(je=>je.path===xe.path);Fe&&V(Fe)}else console.error("Failed to rename script:",xe.error),m(`Failed to rename script: ${xe.error||"Unknown error"}`)}catch(xe){console.error("Error renaming script:",xe),m(`Error renaming script: ${xe instanceof Error?xe.message:String(xe)}`)}finally{P()}}(e(h),ae),cancelRename:P},children:(ae,K)=>{var G=qn(),Ke=S(G);ot(Ke,{content:"Open script in editor",nested:!1,children:(Fe,je)=>{xt(Fe,{size:1,variant:"ghost-block",class:"c-setup-script-selector__action-button",$$events:{click:Ee=>{Ee.stopPropagation(),oe(e(h)),V(e(h))}},children:(Ee,qe)=>{_e(Ee,{name:"external-link"})},$$slots:{default:!0}})},$$slots:{default:!0}});var Le=l(Ke,2);ot(Le,{content:"Rename script",nested:!1,children:(Fe,je)=>{xt(Fe,{size:1,variant:"ghost-block",class:"c-setup-script-selector__action-button",$$events:{click:Ee=>{Ee.stopPropagation(),async function(qe,j){n(T,qe)}(e(h))}},children:(Ee,qe)=>{_e(Ee,{name:"pen"})},$$slots:{default:!0}})},$$slots:{default:!0}});var xe=l(Le,2);ot(xe,{content:"Delete script",nested:!1,children:(Fe,je)=>{xt(Fe,{variant:"ghost-block",class:"c-setup-script-selector__action-button",$$events:{click:Ee=>{Ee.stopPropagation(),async function(qe,j){try{const M=await Q.deleteSetupScript(qe.name,qe.location);M.success?(e(i)?.path===qe.path&&V(null),await x()):(console.error("Failed to delete script:",M.error),m(`Failed to delete script: ${M.error||"Unknown error"}`))}catch(M){console.error("Error deleting script:",M),m(`Error deleting script: ${M instanceof Error?M.message:String(M)}`)}}(e(h))}},children:(Ee,qe)=>{_e(Ee,{name:"trash-2"})},$$slots:{default:!0}})},$$slots:{default:!0}}),t(ae,G)},$$slots:{default:!0}})}};f(X,k=>{e(h)&&k(Ae)}),t(u,B)}},$$legacy:!0}),t(_,d)};f(p,_=>{e(v),Te(ie()),Pe(()=>!e(v)||ie()===L.noScriptsFound)&&_(q)});var te=l(p,2),O=_=>{var d=Kn(),$=r(d);ta($,{color:"warning",variant:"soft",size:2,children:(u,A)=>{var h=Vn(),B=r(h),X=r(B),Ae=l(B,2);gt(Ae,{variant:"ghost",color:"warning",size:1,get loading(){return ce()},$$events:{click:x},children:(k,Y)=>{var ae=ne("Refresh");t(k,ae)},$$slots:{default:!0,iconLeft:(k,Y)=>{var ae=Wn(),K=r(ae);_e(K,{name:"refresh-ccw"}),t(k,ae)}}}),$e(()=>Be(X,ie())),t(u,h)},$$slots:{default:!0}}),t(_,d)};f(te,_=>{e(v),Te(ie()),Pe(()=>e(v)&&ie()!==L.noScriptsFound)&&_(O)}),t(Se,ee),lt(),C()}var Yn=o('<div slot="iconLeft"><!></div>'),Qn=o('<div class="agent-limit-message svelte-14aml4z"><p class="svelte-14aml4z"> </p> <!></div>');function Zn(Se,a){it(a,!1);const s=()=>Ge(W,"$remoteAgentsModel",g),[g,C]=wt(),i=ue(),v=ue();let z=se(a,"agentLimitErrorMessage",28,()=>{});const W=mt(At.key);let w=!1,H=ue(),de=ue(),ie=ue(),ce=ue([]);function ge(){return s().agentOverviews.sort((c,U)=>new Date(c.started_at).getTime()-new Date(U.started_at).getTime())}function he(c){if(!c)return;const U=c.is_setup_script_agent?"Setup script generation":c.session_summary||"";return{id:c.remote_agent_id,title:U.length>30?U.substring(0,27)+"...":U}}function Q(c,U){return c.replace("%MAX_AGENTS%",U.toString())}Ye(()=>s(),()=>{n(i,!!s().maxRemoteAgents&&s().agentOverviews.length>=s().maxRemoteAgents)}),Ye(()=>(s(),oa),()=>{n(v,!!s().maxActiveRemoteAgents&&s().agentOverviews.filter(c=>c.workspace_status===oa.workspaceRunning).length>=s().maxActiveRemoteAgents)}),Ye(()=>(e(i),e(ce),e(H),s(),e(v),e(de),Gt),()=>{if(e(i))n(ce,ge()),n(H,he(e(ce)[0])),z(Q(sa,s().maxRemoteAgents)),n(ie,"Delete Oldest Agent"+(e(H)?`: ${e(H).title}`:""));else if(e(v)){n(ce,ge());const c=e(ce).filter(U=>U.workspace_status===oa.workspaceRunning);n(de,he(c[0])),z(Q(Gt,s().maxActiveRemoteAgents)),n(ie,"Pause Oldest Agent"+(e(de)?`: ${e(de).title}`:""))}else n(H,void 0),z(void 0)}),Ht(),Rt();var N=pe(),ve=S(N),oe=c=>{ta(c,{color:"info",variant:"soft",size:2,icon:T=>{_e(T,{name:"circle-alert"})},children:(T,y)=>{var E=Qn(),R=r(E),F=r(R),L=l(R,2);gt(L,{variant:"soft",color:"neutral",size:1,$$events:{click:()=>{e(v)?async function(){if(!w&&e(de)?.id)try{w=!0,await W.pauseRemoteAgentWorkspace(e(de).id)}catch(x){console.error("Failed to pause oldest active agent:",x)}finally{w=!1}}():async function(){if(!w&&e(H)?.id)try{w=!0,await W.deleteAgent(e(H).id)}catch(x){console.error("Failed to delete oldest agent:",x)}finally{w=!1}}()}},children:(x,P)=>{var m=ne();$e(()=>Be(m,e(ie))),t(x,m)},$$slots:{default:!0,iconLeft:(x,P)=>{var m=Yn(),I=r(m),V=ee=>{_e(ee,{name:"pause"})},J=ee=>{_e(ee,{name:"trash-2"})};f(I,ee=>{e(v)?ee(V):ee(J,!1)}),t(x,m)}}}),$e(x=>Be(F,x),[()=>(e(i),Te(sa),Te(Gt),s(),Pe(()=>(e(i)?sa:Gt).replace("%MAX_AGENTS%",(e(i)?s().maxRemoteAgents:s().maxActiveRemoteAgents).toString())))]),t(T,E)},$$slots:{icon:!0,default:!0}})};f(ve,c=>{z()&&c(oe)}),t(Se,N),lt(),C()}var eo=o('<div class="error-message svelte-1r7cchd"><!></div>'),to=o('<div class="remote-agent-setup svelte-1r7cchd"><div class="content svelte-1r7cchd"><div class="form-fields"><div class="error-message svelte-1r7cchd"><!></div> <!> <div class="commit-ref-selector svelte-1r7cchd"><!></div> <div class="setup-script svelte-1r7cchd"><!> <!></div></div></div></div>'),ao=o("<!> Start Generating Setup Script",1),so=o('<div class="trash-icon"><!></div>'),ro=o("<!> <!> <!>",1),no=o("<!> <!> <!> <!> <!> <!>",1),oo=o("<!> <!>",1);function io(Se,a){it(a,!1);const s=()=>Ge(ge,"$agentIdCopyTextMap",C),g=()=>Ge(he,"$shareLinkCopyTextMap",C),[C,i]=wt();let v=se(a,"agentId",8),z=se(a,"selectedBranch",24,()=>{}),W=se(a,"isPinned",8,!1),w=se(a,"togglePinned",24,()=>{}),H=se(a,"enableRename",8,!1),de=se(a,"isEditing",12,!1),ie=se(a,"onDelete",24,()=>{}),ce=ue();const ge=yt(new Map),he=yt(new Map),Q=mt(At.key);Rt(),Lt(He.Root(Se,{nested:!1,children:(N,ve)=>{var oe=oo(),c=S(oe);He.Trigger(c,{children:(T,y)=>{xt(T,{variant:"ghost-block",color:"neutral",size:1,title:"Agent options",children:(E,R)=>{_e(E,{name:"ellipsis"})},$$slots:{default:!0}})},$$slots:{default:!0}});var U=l(c,2);He.Content(U,{size:1,side:"bottom",align:"end",children:(T,y)=>{var E=no(),R=S(E),F=b=>{He.Item(b,{onSelect:()=>{setTimeout(()=>{de(!0)},20)},children:(p,q)=>{var te=ne("Rename");t(p,te)},$$slots:{default:!0,iconLeft:(p,q)=>{_e(p,{slot:"iconLeft",name:"square-pen"})}}})};f(R,b=>{H()&&b(F)});var L=l(R,2),x=b=>{He.Item(b,{title:"Pin or unpin agent",onSelect:()=>{w()()},children:(p,q)=>{var te=ne();$e(()=>Be(te,W()?"Unpin":"Pin")),t(p,te)},$$slots:{default:!0,iconLeft:(p,q)=>{_e(p,{name:"pin",class:"pin-icon",slot:"iconLeft"})}}})};f(L,b=>{w()&&b(x)});var P=l(L,2);He.Item(P,{onSelect:()=>{navigator.clipboard.writeText(v()),ge.update(b=>(b.set(v(),"Copied!"),b)),setTimeout(()=>{ge.update(b=>(b.delete(v()),b))},1e3)},children:(b,p)=>{var q=pe(),te=S(q),O=d=>{var $=ne();$e(u=>Be($,u),[()=>(s(),Te(v()),Pe(()=>s().get(v())))]),t(d,$)},_=d=>{var $=ne("Copy ID");t(d,$)};f(te,d=>{s(),Te(v()),Pe(()=>s().get(v()))?d(O):d(_,!1)}),t(b,q)},$$slots:{default:!0,iconLeft:(b,p)=>{_e(b,{name:"copy",slot:"iconLeft"})}}});var m=l(P,2);He.Item(m,{onSelect:()=>{(async function(){try{const b=await Q?.getConversationUrl(v());b&&navigator.clipboard.writeText(b),he.update(p=>(p.set(v(),"Link copied!"),p)),setTimeout(()=>{he.update(p=>(p.delete(v()),p))},1e3)}catch(b){console.error("Failed to get conversation URL: ",b)}})(),e(ce)?.requestClose()},children:(b,p)=>{var q=pe(),te=S(q),O=d=>{var $=ne();$e(u=>Be($,u),[()=>(g(),Te(v()),Pe(()=>g().get(v())))]),t(d,$)},_=d=>{var $=ne("Share");t(d,$)};f(te,d=>{g(),Te(v()),Pe(()=>g().get(v()))?d(O):d(_,!1)}),t(b,q)},$$slots:{default:!0,iconLeft:(b,p)=>{_e(b,{slot:"iconLeft",name:"share-2"})}}});var I=l(m,2),V=b=>{He.Item(b,{color:"error",onSelect:()=>{ie()?.()},children:(p,q)=>{var te=ne("Delete");t(p,te)},$$slots:{default:!0,iconLeft:(p,q)=>{var te=so(),O=r(te);_e(O,{name:"trash-2"}),t(p,te)}}})};f(I,b=>{ie()&&b(V)});var J=l(I,2),ee=b=>{var p=ro(),q=S(p);He.Separator(q,{});var te=l(q,2);He.Label(te,{children:(_,d)=>{var $=ne("Branch");t(_,$)},$$slots:{default:!0}});var O=l(te,2);He.Item(O,{disabled:!0,children:(_,d)=>{var $=ne();$e(()=>Be($,z())),t(_,$)},$$slots:{default:!0}}),t(b,p)};f(J,b=>{z()&&b(ee)}),t(T,E)},$$slots:{default:!0}}),t(N,oe)},$$slots:{default:!0},$$legacy:!0}),N=>n(ce,N),()=>e(ce)),lt(),i()}var lo=o('<div class="c-thread-header__banner svelte-4g48lc"><!></div>'),co=o('<div class="c-thread-header__title-notice"><!></div>'),uo=o('<div class="c-thread-header__info-row svelte-4g48lc"><!></div>'),vo=o('<div class="c-thread-header__status svelte-4g48lc"><!></div>'),ho=o('<div class="c-thread-header svelte-4g48lc"><!> <!> <!> <!></div>');const po=Se=>{var a=bo(),s=r(a);Me(s,{size:1,weight:"medium",children:(g,C)=>{var i=$o();t(g,i)},$$slots:{default:!0}}),t(Se,a)};var go=o('<div class="c-agent-header-banner__with-icon svelte-i2xeo6"><!> <div class="c-agent-header-banner__stack svelte-i2xeo6"><div class="c-agent-header-banner__text svelte-i2xeo6">Running in the cloud</div> <div class="c-agent-header-banner__text c-agent-header-banner__text--secondary svelte-i2xeo6">Workspace opened via SSH in this VSCode window</div></div></div>'),mo=o('<span class="c-agent-header-banner__text svelte-i2xeo6"><div class="c-setup-script-badge svelte-i2xeo6"><!></div> Generate a setup script</span>'),fo=o('<div class="c-agent-header__actions svelte-i2xeo6"><!></div>'),_o=o('<div class="c-agent-header__banner svelte-i2xeo6"><!> <!></div>'),$o=o(`We've tasked an agent to generate a setup script for your repository.<span class="c-agent-title-content__long-text-alternative svelte-i2xeo6">..</span> <span class="c-agent-title-content__long-text svelte-i2xeo6">Once created, save it to use in a new remote agent, to install dependencies & configure the
        env before the agent starts.</span>`,1),bo=o('<div class="c-agent-title-content svelte-i2xeo6"><!></div>'),wo=o('<div class="c-agent-info-row svelte-i2xeo6"><!> <!></div>'),yo=o("<div><!></div>");function Ro(Se,a){it(a,!0);const s=()=>Ge(z,"$remoteAgentsModel",g),[g,C]=wt(),i=y=>{var E=_o(),R=r(E),F=m=>{var I=go(),V=r(I);_e(V,{name:"cloud-upload",size:2}),t(m,I)},L=m=>{var I=pe(),V=S(I),J=ee=>{var b=mo(),p=r(b),q=r(p);_e(q,{name:"square-terminal",size:2}),t(ee,b)};f(V,ee=>{e(ie)&&ee(J)},!0),t(m,I)};f(R,m=>{e(ge)?m(F):m(L,!1)});var x=l(R,2),P=m=>{var I=fo();io(r(I),{get agentId(){return e(w)},get selectedBranch(){return e(N)},get isPinned(){return e(ce)},togglePinned:he,onDelete:Q}),t(m,I)};f(x,m=>{e(w)&&e(ve)&&m(P)}),t(y,E)},v=y=>{var E=wo(),R=r(E);Qs(R,{get repoUrl(){return e(H)},get repoName(){return e(de)}});var F=l(R,2),L=x=>{Zs(x,{get repoUrl(){return e(H)},get branchName(){return e(N)}})};f(F,x=>{e(N)&&x(L)}),t(y,E)},z=mt(At.key),W=D(()=>s()?.currentAgent),w=D(()=>e(W)?.remote_agent_id),H=D(()=>e(W)?.workspace_setup?.starting_files?.github_commit_ref?.repository_url||""),de=D(()=>Hs(e(H))),ie=D(()=>e(W)?.is_setup_script_agent),ce=D(()=>e(w)&&s()?.pinnedAgents[e(w)]||!1),ge=D(()=>s()?.isRemoteAgentSshWindow);function he(){e(w)&&z?.toggleAgentPinned(e(w),e(ce))}const Q=async()=>{!e(w)||!z||await z?.deleteAgent(e(w))&&z.setCurrentAgent(void 0)},N=D(()=>e(W)?.workspace_setup?.starting_files?.github_commit_ref?.git_ref),ve=D(()=>e(ge)||e(ie)),oe=D(()=>e(w)&&e(ve));var c=pe(),U=S(c),T=y=>{var E=yo();let R;var F=r(E);{let L=D(()=>e(ve)||e(oe)?i:void 0),x=D(()=>e(ie)?po:void 0);(function(P,m){const I=se(m,"isSquished",3,!1);var V=ho(),J=r(V),ee=d=>{var $=lo(),u=r($);Et(u,()=>m.banner),t(d,$)};f(J,d=>{m.banner&&d(ee)});var b=l(J,2),p=d=>{var $=co(),u=r($);Et(u,()=>m.titleNotice),t(d,$)};f(b,d=>{m.titleNotice&&d(p)});var q=l(b,2),te=d=>{var $=uo(),u=r($);Et(u,()=>m.infoRow),t(d,$)};f(q,d=>{!I()&&m.infoRow&&d(te)});var O=l(q,2),_=d=>{var $=vo(),u=r($);Et(u,()=>m.status),t(d,$)};f(O,d=>{m.status&&d(_)}),t(P,V)})(F,{get banner(){return e(L)},get titleNotice(){return e(x)},get infoRow(){return v}})}$e(L=>R=Yt(E,1,"c-agent-header svelte-i2xeo6",null,R,L),[()=>({"c-agent-header--setup-script":e(ie),"c-agent-header--is-in-remote":e(ge)})]),t(y,E)};f(U,y=>{e(W)&&y(T)}),t(Se,c),lt(),C()}var Ao=o('<!> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),So=o('<div class="l-input-area-agent-setup l-input-area-design-system svelte-17wmks3"><!></div>'),Co=o("<!> <!>",1),ko=o("<!> <!>",1),Lo=o("<!> <!> <!> <!>",1);function wi(Se,a){it(a,!0);const s=()=>Ge(i,"$remoteAgentsModel",g),[g,C]=wt(),i=mt(At.key);let v=D(()=>s().isActive&&!s().currentAgentId),z=D(()=>!e(v)),W=D(()=>s().currentAgentId),w=D(()=>s().getCurrentChatHistory()?.length),H=D(()=>s().agentSetupLogs?.steps.length!==0),de=D(()=>Ja(!e(w)&&!e(H))),ie=D(()=>`remote-${e(W)}`);const ce=D(()=>s().isActive&&s().currentAgent&&!s().currentAgent?.is_setup_script_agent),ge=ea(),he=D(()=>s().isCreatingAgent||s().isActive&&s().currentAgent?.status===bt.agentStarting),Q=D(()=>e(he)?"Remote Agent is starting":s().isActive?s().currentAgentId?"Ask Remote Agent to edit code, run tests, create a pull request":"Fix this bug, tackle this ticket, review comments in my pull request":void 0);let N=nt(void 0);var ve=Lo(),oe=S(ve),c=L=>{qt(L,{get target(){return`#${vs}`},children:(x,P)=>{Ro(x,{})},$$slots:{default:!0}})};f(oe,L=>{s()?.isActive&&L(c)});var U=l(oe,2),T=L=>{qt(L,{get target(){return`#${ra.inputHint}`},children:(x,P)=>{var m=Ao(),I=S(m);Me(I,{size:1,class:"c-chat-input-hint",children:(J,ee)=>{var b=ne(`Kick off a remote agent to work in parallel, in an isolated environment that will keep
      running, even when you shut off your computer.`);t(J,b)},$$slots:{default:!0}});var V=l(I,2);Xa(V,()=>({"--text-color":"var(--ds-color-accent-a11)"})),Me(V.lastChild,{size:1,class:"c-chat-open-secret-manager",onclick:J=>{J.preventDefault(),ge.openSettingsPage("secret-manager")},children:(J,ee)=>{var b=ne("Need secrets to do the work? Configure them here.");t(J,b)},$$slots:{default:!0}}),t(x,m)},$$slots:{default:!0}})};f(U,L=>{e(v)&&L(T)});var y=l(U,2),E=L=>{var x=pe(),P=S(x);Ta(P,()=>e(ie),m=>{var I=pe(),V=S(I),J=ee=>{hs(ee,{})};f(V,ee=>{Ge(e(de),"$isEmptyConversation",g)||ee(J)}),t(m,I)}),t(L,x)};f(y,L=>{e(z)&&L(E)});var R=l(y,2),F=L=>{var x=ko(),P=S(x);qt(P,{get target(){return`#${ra.divider}`},children:(I,V)=>{ps(I,{get inputArea(){return e(N)},set inputArea(J){n(N,J,!0)}})},$$slots:{default:!0}});var m=l(P,2);qt(m,{get target(){return`#${ra.input}`},children:(I,V)=>{var J=Co(),ee=S(J),b=O=>{Ar(O,{})};f(ee,O=>{e(ce)&&O(b)});var p=l(ee,2),q=O=>{Pa(O,{editable:!0,hasSendButton:!0,get placeholder(){return e(Q)},banner:d=>{jr(d,{})},$$slots:{banner:!0}})},te=O=>{var _=So();{const d=u=>{(function(A,h){it(h,!1);const B=()=>Ge(G,"$remoteAgentsModel",X),[X,Ae]=wt(),k=ue(),Y=ue(),ae=ue(),K=ue(),G=mt(At.key),Ke=mt(Zt.key);let Le=ue(""),xe=ue(!1),Fe=ue(),je=ue(null),Ee=ue(null),qe=ue(null);Ot(async()=>{try{const le=await G.getLastRemoteAgentSetup();n(je,le.lastRemoteAgentGitRepoUrl),n(Ee,le.lastRemoteAgentGitBranch),n(qe,le.lastRemoteAgentSetupScript),G.setHasEverUsedRemoteAgent(!0),await G.reportRemoteAgentEvent({eventName:Oa.setupPageOpened,remoteAgentId:"",eventData:{setupPageOpened:{}}}),await G.reportRemoteAgentSetupWindowEvent(kt.open)}catch(le){console.error("Failed to load last remote agent setup:",le)}}),Qt(async()=>{try{await G.reportRemoteAgentSetupWindowEvent(kt.close)}catch(le){console.error("Failed to report remote agent setup window close event:",le)}G.setNewAgentDraft(null),G.setCreationMetrics(void 0)}),Ye(()=>B(),()=>{n(k,B().newAgentDraft?.commitRef??null)}),Ye(()=>B(),()=>{n(Y,B().newAgentDraft?.selectedBranch??null)}),Ye(()=>(e(k),e(Y),e(xe),e(Le),e(Fe)),()=>{n(ae,(()=>{const le=e(k)?.github_commit_ref?.repository_url,ke=e(Y)?.name,rt=!e(xe)&&le&&ke;return e(Le)||e(Fe)||(e(xe)?"Loading repos and branches...":"")||!le&&"Please select a repository"||!ke&&"Please select a branch"||(!rt&&le&&ke?"Loading branch data...":"")||""})())}),Ye(()=>e(ae),()=>{n(K,!!e(ae))}),Ye(()=>e(K),()=>{G.newAgentDraft&&G.newAgentDraft.isDisabled!==e(K)&&G.setNewAgentDraft({...G.newAgentDraft,isDisabled:e(K)})}),Ht(),Rt();var j=to(),M=r(j),be=r(M),Je=r(be);Zn(r(Je),{get agentLimitErrorMessage(){return e(Fe)},set agentLimitErrorMessage(le){n(Fe,le)},$$legacy:!0});var Z=l(Je,2),De=le=>{var ke=eo(),rt=r(ke);ta(rt,{color:"error",variant:"soft",size:2,children:(at,Xe)=>{var re=ne();$e(()=>Be(re,(B(),Pe(()=>B().remoteAgentCreationError)))),t(at,re)},$$slots:{default:!0}}),Kt(3,ke,()=>$a,()=>({y:10})),t(le,ke)};f(Z,le=>{B(),Pe(()=>B().remoteAgentCreationError)&&le(De)});var Ce=l(Z,2);Bn(r(Ce),{get gitRefModel(){return Ke},get lastUsedRepoUrl(){return e(je)},get lastUsedBranchName(){return e(Ee)},onSelectedRepo:async function(){const le=G.creationMetrics;G.setCreationMetrics({changedRepo:!0,changedBranch:le?.changedBranch??!1});try{await G.reportRemoteAgentSetupWindowEvent(kt.selectRepo)}catch(ke){console.error("Failed to report repo selection event:",ke)}},onSelectedBranch:async function(){const le=G.creationMetrics;G.setCreationMetrics({changedRepo:le?.changedRepo??!1,changedBranch:!0});try{await G.reportRemoteAgentSetupWindowEvent(kt.selectBranch)}catch(ke){console.error("Failed to report branch selection event:",ke)}},get errorMessage(){return e(Le)},set errorMessage(le){n(Le,le)},get isLoading(){return e(xe)},set isLoading(le){n(xe,le)},$$events:{commitRefChange:async function(le){G.setRemoteAgentCreationError(null);const ke=G.newAgentDraft;ke?G.setNewAgentDraft({...ke,commitRef:le.detail.commitRef,selectedBranch:le.detail.selectedBranch,isDisabled:e(K)}):G.setNewAgentDraft({commitRef:le.detail.commitRef,selectedBranch:le.detail.selectedBranch,setupScript:null,isDisabled:e(K),enableNotification:!0})}},$$legacy:!0});var me=l(Ce,2),fe=r(me);Xn(fe,{get lastUsedScriptPath(){return e(qe)},$$events:{setupScriptChange:function(le){G.setRemoteAgentCreationError(null);const ke=G.newAgentDraft;ke?G.setNewAgentDraft({...ke,setupScript:le.detail.script,isDisabled:e(K)}):G.setNewAgentDraft({commitRef:null,selectedBranch:null,setupScript:le.detail.script,isDisabled:e(K),enableNotification:!0})}}});var Re=l(fe,2);Fs(Re,{size:4}),Kt(3,Je,()=>$a,()=>({y:10})),t(A,j),lt(),Ae()})(u,{})},$=u=>{(function(A,h){it(h,!0);let B=nt(!1);gt(A,{size:1,variant:"solid",color:"accent",onclick:async()=>{n(B,!0);try{try{await h.remoteAgentsModel.reportRemoteAgentSetupWindowEvent(kt.autoGenerateSetupScript)}catch(k){console.error("Failed to auto-generate setup script event:",k)}const X=h.remoteAgentsModel.newAgentDraft;X&&h.remoteAgentsModel.setNewAgentDraft({...X,isSetupScriptAgent:!0});const Ae=await h.remoteAgentsModel.createRemoteAgentFromDraft("SETUP_MODE");Ae&&h.remoteAgentsModel.setCurrentAgent(Ae)}catch(X){console.error("Failed to select setup script generation:",X)}finally{n(B,!1)}},get loading(){return e(B)},children:(X,Ae)=>{var k=ao(),Y=S(k);_e(Y,{name:"wand-sparkles"}),t(X,k)},$$slots:{default:!0}}),lt()})(u,{get remoteAgentsModel(){return i}})};Pa(r(_),{editable:!0,hasSendButton:!0,get placeholder(){return e(Q)},banner:d,activeButton:$,$$slots:{banner:!0,activeButton:!0}})}Lt(_,d=>n(N,d),()=>e(N)),t(O,_)};f(p,O=>{s().currentAgent?.is_setup_script_agent&&s().currentConversation?O(q):O(te,!1)}),t(I,J)},$$slots:{default:!0}}),t(L,x)};f(R,L=>{s().isActive&&L(F)}),t(Se,ve),lt(),C()}export{wi as default};
//# sourceMappingURL=RemoteMessageSection-OPbxN2sc.js.map
